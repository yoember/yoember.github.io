<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"> <title>Ember 2 Tutorial - From beginner to advance - yoember.com</title> <meta name="description" content="Free Ember.js tutorial for absolute beginners. Build a CRUD application from step by step with the latest Ember.js v2.8. "> <meta name="google-site-verification" content="U42b-ZgXzrF6rhQTCtbrmiSvRBUigl0IoHE-5bhz64c"/> <link rel="canonical" href="http://yoember.com/"> <link rel="alternate" type="application/rss+xml" title="Ember v2.8 Tutorial - Building a complex web application" href="http://yoember.com/feed.xml"> <link rel="icon" href="/favicon.png?678"> <link type="text/css" rel="stylesheet" href="/assets/app-5ca499c858c7c12763e2b46803373bb844ced165cf1c05590e60327b4170ce97.css"> </head> <body data-identifier="library-app"> <header> <nav class="navbar navbar-default blog-masthead"> <div class="container"> <div class="navbar-header"> <a class="navbar-brand" href="http://yoember.com" aria-label="Emberjs tutorial">yoember.com</a> </div> </div> </nav> </header> <div class="container"> <h1 id="ember-2-tutorial">Ember 2 Tutorial</h1> <h2 id="building-a-complex-web-application-with-emberjs-28">Building a complex web application with Ember.js 2.8</h2> <p class="blog-post-meta">Latest update: <time datetime="2016-09-24" itemprop="datePublished">24 Sept 2016</time> • <span itemprop="author" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name"><a href="http://zoltan.nz">Zoltan</a></span></span></p> <p>Welcome! This is an <a href="http://yoember.com">Ember.js 2 tutorial</a> from the absolute beginner level. End of the course we touch some advanced topic as well.</p> <p>Please check the <a href="https://library-app.firebaseapp.com">Live Demo</a> page and play with the app what we are going to build together.</p> <ul> <li>Live demo: <a href="https://library-app.firebaseapp.com/">library-app.firebaseapp.com</a></li> </ul> <p>You can clone the original repository from GitHub and launch on your desktop anytime.</p> <ul> <li>Original repo: <a href="https://github.com/zoltan-nz/library-app">https://github.com/zoltan-nz/library-app</a></li> </ul> <p>If you have any comment, suggestion or you have a question, please feel free to contact me.</p> <ul> <li>My Twitter: <a href="https://www.twitter.com/zoltan_nz">@zoltan_nz</a></li> <li>My Website: <a href="http://zoltan.nz">zoltan.nz</a></li> </ul> <p>Don’t hesitate to send me a message on Ember.js community Slack Channel.</p> <ul> <li>Ember.js Community Slack: <a href="https://embercommunity.slack.com/messages/general/team/zoltan/">@zoltan</a></li> </ul> <p>Or leave a comment at the <a href="#disqus_thread">bottom of this page</a>.</p> <p>Contributors: <a href="https://github.com/jkeat">@jkeat</a>, I really appreciate the effort you have put into proofreading this <a href="http://yoember.com">Ember tutorial</a>. <a href="https://github.com/sigu">@sigu</a>, <a href="https://github.com/batisteo">@batisteo</a>, thanks guys for fixing too.</p> <blockquote> <p>Could you please help with my university research project, I have a super short survey about programming tutorials: <a href="https://goo.gl/WFS0nX">Survey</a> Thanks! :)</p> </blockquote> <h2 id="other-tutorials-examples">Other tutorials, examples</h2> <ul> <li>ProductApp - a tutorial where we building an online store together with Ember.js, WIP: <a href="https://github.com/zoltan-nz/product-app">https://github.com/zoltan-nz/product-app</a></li> <li>MapTouch - playing with d3.js, animation and canvases: <a href="https://github.com/zoltan-nz/map-touch">https://github.com/zoltan-nz/map-touch</a></li> <li>Bookstore API (Ruby on Rails): <a href="https://github.com/zoltan-nz/bookstore-api">https://github.com/zoltan-nz/bookstore-api</a></li> <li>Bookstore Client (Ember.js): <a href="https://github.com/zoltan-nz/bookstore-client">https://github.com/zoltan-nz/bookstore-client</a></li> <li>Contacts App Client (Ember.js): <a href="https://github.com/zoltan-nz/contacts-app-client">https://github.com/zoltan-nz/contacts-app-client</a></li> <li>Chat App (Ember.js): <a href="https://github.com/zoltan-nz/chat-app-v2">https://github.com/zoltan-nz/chat-app-v2</a></li> </ul> <h2 id="contents">Contents</h2> <ul> <li><a href="#lesson-1">Lesson 1 - Creating our first static page with Ember.js</a> <ul> <li><a href="#ember-bootstrap-sass">Add Bootstrap and Sass to Ember.js App</a></li> </ul> </li> <li><a href="#lesson-2">Lesson 2 - Computed property, actions, dynamic content</a></li> <li><a href="#lesson-3">Lesson 3 - Models, saving data in database</a></li> <li><a href="#lesson-4">Lesson 4 - Deploy your app and add more CRUD functionality</a></li> <li><a href="#lesson-5">Lesson 5 - Data down actions up, using components</a></li> <li><a href="#lesson-6">Lesson 6 - Advance model structures and data relationships</a></li> <li><a href="#lesson-7">Lesson 7 - CRUD interface for Authors and Books, managing model relationship</a></li> </ul> <h2 id="prerequisites">Prerequisites</h2> <ul> <li>node.js: at least 0.12, but the best if you install the latest version 6 (current release).</li> </ul> <p><a href="/nodejs/the-best-way-to-install-node-js/">The best way to install Node.js on Mac, Linux and on Windows</a></p> <ul> <li>Ember Inspector Chrome Extension</li> </ul> <p>Install Ember Inspector Chrome extension in your Chrome Browser: <a href="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi?hl=en">Ember Inspector</a></p> <ul> <li>(Optional but suggested on Mac and Linux) Watchman from Facebook</li> </ul> <p>Install Watchman on Mac: <code class="highlighter-rouge">brew install watchman</code> More info: <a href="https://facebook.github.io/watchman/">https://facebook.github.io/watchman/</a></p> <p>Watchman increases the speed of the build process significantly.</p> <h2 id="lesson-1"><a name="lesson-1"></a>Lesson 1</h2> <p>This tutorial uses the latest Ember CLI tool (v2.8.0).</p> <h3 id="install-ember-cli">Install Ember CLI</h3> <p>The following <code class="highlighter-rouge">npm</code> command installs Ember CLI latest stable version in the global namespace. The latest Ember CLI version 2.8.0 was released on 9th of September 2016, it generates app with Ember.js v2.8 and Ember Data v2.8. (If you have an earlier version of Ember CLI, the following command automatically updates it to the latest.)</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ npm install -g ember-cli
</code></pre></div> <p>or if you would like to install the next beta version:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ npm install -g ember-cli@2.9.0-beta.2
</code></pre></div> <p>You have now a new <code class="highlighter-rouge">ember</code> command in your console. Check with</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember -v
</code></pre></div> <p>You should see something similar:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>version: 2.8.0
node: 6.6.0
os: darwin x64
</code></pre></div> <p>(Node version, npm version and OS version may be different in your configuration.)</p> <p>Please read more about Ember CLI here: <a href="http://www.ember-cli.com">www.ember-cli.com</a></p> <h3 id="create-the-app">Create the app</h3> <p>In your terminal, navigate in the folder where you usually create your web applications. For example, if you have a <code class="highlighter-rouge">projects</code> folder use</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">cd</span> ~/projects
</code></pre></div> <p>Inside this folder run the following command.</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember new library-app
</code></pre></div> <p>This command will create the new app for you.</p> <p>Please change to your new app directory with:</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">cd </span>library-app
</code></pre></div> <p>Open this folder in your favourite code editor and look around. You will see a few files and folders. Ember CLI is scaffolded for you everything what need to run and create an amazing web application.</p> <h3 id="launch-the-app">Launch the app</h3> <p>Your skeleton app is ready and you can run it with the following command. Type in your terminal:</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember server
</code></pre></div> <p>Open your new empty app in your browser: <a href="http://localhost:4200" target="_blank">http://localhost:4200</a></p> <p>If you use the latest Ember v2.8, you should see a page with our happy Tomster and “Congratulations, you made it”. This is the new Ember Welcome Page.</p> <p>If you use an earlier version of Ember (for example v2.5), you should see a “Welcome to Ember” message on your website.</p> <p>Well Done! You have your first Ember.js application. :)</p> <p>From version 2.6, we have to generate our <code class="highlighter-rouge">application.hbs</code>, the main template page, manually. In the previous versions we had it automatically.</p> <p>Open your terminal, stop the server with <code class="highlighter-rouge">Ctrl+C</code> and run the following command:</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember generate template application
</code></pre></div> <p>This command generates your main template file: <code class="highlighter-rouge">app/templates/application.hbs</code>.</p> <p>Open this file in your favourite editor and add the following html code:</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span>Welcome to Ember<span class="nt">&lt;/h1&gt;</span>
</code></pre></div> <p>With this step, we recreate the same home page, what we had in earlier versions of Ember. Launch your server from your console with:</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember server
</code></pre></div> <p>Reload your app in your browser. Our favourite Tomster disappeard but we have a clean welcome message in our amazing app.</p> <p>You can open Ember Inspector in your Browser. Hope you’ve already installed it. Ember Inspector exists in Chrome and in Firefox as an extension. After installation you should have a new tab in your developer console in your browser. Check it out, look around. <a href="https://guides.emberjs.com/v2.8.0/ember-inspector/installation/">More details about Ember Inspector here</a>.</p> <p>(If you really miss our Tomster you can visit him on this page: <a href="http://localhost:4200/ember-getting-started">http://localhost:4200/ember-getting-started</a>.)</p> <h3 id="turn-on-a-few-debugging-options">Turn on a few debugging options</h3> <p>If you would like to see more information in your browser’s console about what Ember.js is doing under the hood, you can turn on a few debugging options in your configuration file.</p> <p>You can find a list of debugging options in <code class="highlighter-rouge">./config/environment.js</code> file. Remove the comment sign as follow:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">//..</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">environment</span> <span class="o">===</span> <span class="s1">'development'</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ENV.APP.LOG_RESOLVER = true;</span>
  <span class="nx">ENV</span><span class="p">.</span><span class="nx">APP</span><span class="p">.</span><span class="nx">LOG_ACTIVE_GENERATION</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="nx">ENV</span><span class="p">.</span><span class="nx">APP</span><span class="p">.</span><span class="nx">LOG_TRANSITIONS</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="nx">ENV</span><span class="p">.</span><span class="nx">APP</span><span class="p">.</span><span class="nx">LOG_TRANSITIONS_INTERNAL</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="nx">ENV</span><span class="p">.</span><span class="nx">APP</span><span class="p">.</span><span class="nx">LOG_VIEW_LOOKUPS</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//..</span>
</code></pre></div> <p>Check your app and open the Console in Chrome/Firefox. You will see some extra information about what Ember.js actually does under the hood. Don’t worry if you don’t understand these debug messages at this stage. As you spend more and more time with Ember.js development, these lines are going to be clearer. (If you prefer to keep your development console clear, just comment out these debugging options. You can turn on and off them, whenever you like.)</p> <h3 id="add-bootstrap-and-sass-to-emberjs-app"><a name="ember-bootstrap-sass"></a>Add Bootstrap and Sass to Ember.js App</h3> <p>Let’s add some basic style to our application. We use Bootstrap with Sass. Ember CLI can install for us add-ons and useful packages. These add-ons simplify our development process, because we don’t have to reinvent the wheel, we get more out of the box. You can find various packages, add-ons on these websites: <a href="http://www.emberaddons.com">http://www.emberaddons.com</a> or <a href="http://www.emberobserver.com">http://www.emberobserver.com</a></p> <p>We install an add-on for Sass and another for Bootstrap.</p> <p>Exit your <code class="highlighter-rouge">ember server</code> with <code class="highlighter-rouge">Ctrl+C</code> in your terminal.</p> <p>Run the following two commands:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember install ember-cli-sass
$ ember install ember-cli-bootstrap-sassy
</code></pre></div> <p>You will see, that your <code class="highlighter-rouge">./package.json</code> and <code class="highlighter-rouge">./bower.json</code> are extended with a couple of lines.</p> <p>Rename your <code class="highlighter-rouge">app.css</code> to <code class="highlighter-rouge">app.scss</code> with the following terminal command or you can use your editor to rename the <code class="highlighter-rouge">./app/styles/app.css</code> file:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ mv app/styles/app.css app/styles/app.scss
</code></pre></div> <p>Open <code class="highlighter-rouge">./app/styles/app.scss</code> file in your editor and add the following line:</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>
</code></pre></div> <p>Relaunch your app with <code class="highlighter-rouge">ember server</code>. You should see in the browser, that ‘Welcome to Ember’ uses Bootstrap default font.</p> <p>Above steps in a one liner. Copy-paste in your console (without $). This is useful if you create a new project and you would like to add Bootstrap in a second.</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember install ember-cli-sass <span class="o">&amp;&amp;</span> ember install ember-cli-bootstrap-sassy <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'@import "bootstrap";'</span> &gt; ./app/styles/app.scss <span class="o">&amp;&amp;</span> rm ./app/styles/app.css
</code></pre></div> <h3 id="create-a-navigation-partial"><a name="navigation-bar"></a>Create a navigation partial</h3> <p>We will use bootstrap navigation bar to create a nice header section for our app.</p> <p>Update your main template file. (Remember, from Ember v2.6, <code class="highlighter-rouge">application.hbs</code> is not there automatically, we have to create it with <code class="highlighter-rouge">ember generate template application</code> command.) Delete the example content and add the following code to your <code class="highlighter-rouge">./app/templates/application.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="k">{{</span><span class="nv">partial</span> <span class="s1">'navbar'</span><span class="k">}}</span>
  <span class="k">{{</span><span class="nv">outlet</span><span class="k">}}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>Ember uses handlebar syntax in templates. It is almost the same as plain html, but you could have dynamic elements with <code class="highlighter-rouge"><span class="p">{</span><span class="err">{</span><span class="p">}</span><span class="err">}</span></code>.</p> <p>You can insert snippets from other templates with the <code class="highlighter-rouge">partial</code> helper.</p> <p>The <code class="highlighter-rouge">outlet</code> helper is a general helper, a placeholder, where deeper level content will be inserted. The <code class="highlighter-rouge">outlet</code> in <code class="highlighter-rouge">application.hbs</code> means that almost all content from other pages will appear inside this section. For this reason, <code class="highlighter-rouge">application.hbs</code> is a good place to determine the main structure of our website. In our case we have a <code class="highlighter-rouge">container</code> div, a navigation bar, and the real content.</p> <p>Generate a <code class="highlighter-rouge">navbar.hbs</code> file with the following command in you terminal.</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember generate template navbar
</code></pre></div> <p>You can open <code class="highlighter-rouge">./app/templates/navbar.hbs</code> in your editor and add the following lines:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"navbar navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"navbar-header"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"navbar-toggle collapsed"</span> <span class="na">data-toggle=</span><span class="s">"collapse"</span> <span class="na">data-target=</span><span class="s">"#main-navbar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Toggle navigation<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;/button&gt;</span>
      <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"navbar-brand"</span><span class="k">}}</span>Library App<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"main-navbar"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
            <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.navbar-collapse --&gt;</span>
  <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.container-fluid --&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</code></pre></div> <p>Ember provides a bunch of useful handlebar helpers. The <code class="highlighter-rouge"><span class="p">{</span><span class="err">{#link-to</span><span class="p">}</span><span class="err">}</span><span class="p">{</span><span class="err">{/link-to</span><span class="p">}</span><span class="err">}</span></code> helps to create links. In this case we use as a block helper. The first parameter is the route name (<code class="highlighter-rouge">index</code>). Inside the block goes the label of the link. <code class="highlighter-rouge">link-to</code> uses <code class="highlighter-rouge">&lt;a&gt;</code> tag as default, but you can set up a different tag with the <code class="highlighter-rouge">tagName</code> property. We need this slightly hacky solution because of Bootstrap, however later we will implement a <a href="#nav-link-to">nicer component</a> to manage navigation links.</p> <p>Launch your application with <code class="highlighter-rouge">ember server</code>. You should see your new navigation bar in your browser.</p> <p>You can update your <code class="highlighter-rouge">app.scss</code> file to add some extra padding to the top. The updated <code class="highlighter-rouge">./app/styles/app.scss</code> content:</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">padding-top</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div> <h3 id="create-a-new-about-page-and-add-the-link-to-the-menu-bar"><a name="about-page"></a>Create a new About page and add the link to the menu bar</h3> <p>Let’s create a new About page.</p> <p>Run the following command in your terminal</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember generate route about
</code></pre></div> <p>A new route and template created in your project.</p> <p>Open your new <code class="highlighter-rouge">./app/templates/about.hbs</code> file in your editor, delete its content and add the following line:</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span>About Page<span class="nt">&lt;/h1&gt;</span>
</code></pre></div> <p>You can launch your app with <code class="highlighter-rouge">ember server</code> and navigate to <code class="highlighter-rouge">http://localhost:4200/about</code>, where you should see the newly created <code class="highlighter-rouge">About Page</code> header message. If you click on <code class="highlighter-rouge">Home</code> in your menu bar, your page will be empty. Let’s fix that.</p> <p>Create a new <code class="highlighter-rouge">index</code> template with the following command in your terminal:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember generate template index
</code></pre></div> <p>Open in your editor the newly generated <code class="highlighter-rouge">./app/templates/index.hbs</code> file and add the following:</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span>Home Page<span class="nt">&lt;/h1&gt;</span>
</code></pre></div> <p>If you launch your app, you should see the above message on your home page, however we still don’t have an <code class="highlighter-rouge">About</code> link in our menu bar.</p> <p>Open your <code class="highlighter-rouge">./app/templates/navbar.hbs</code> and add the following line to the <code class="highlighter-rouge">ul</code> section under the <code class="highlighter-rouge">Home</code> link:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'about'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
</code></pre></div> <p>Your <code class="highlighter-rouge">ul</code> section in <code class="highlighter-rouge">navbar.hbs</code> should look like this:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'about'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div> <p>If you check your app in the browser, you should see <code class="highlighter-rouge">Home</code> and <code class="highlighter-rouge">About</code> links in your menu bar. You can click on them and see how the page content and the url are changed. The <code class="highlighter-rouge">active</code> state of the link changes the style of the menu link automatically as well. However Bootstrap expect the <code class="highlighter-rouge">active</code> class in <code class="highlighter-rouge">li</code> and expects an anchor tag inside the <code class="highlighter-rouge">li</code> tag. For this reason we have to insert that empty anchor around menu labels. We will fix this with a nice component later.</p> <h3 id="homework">Homework</h3> <p>Create a <code class="highlighter-rouge">Contact</code> page. Extend the navigation bar with a “Contact” menu item.</p> <h2 id="lesson-2"><a name="lesson-2"></a>Lesson 2</h2> <h3 id="coming-soon-homepage-with-an-email-input-box">Coming Soon homepage with an email input box</h3> <p>Let’s create a coming soon “jumbotron” on the home page with an email input box, where users can subscribe for a newsletter.</p> <ul> <li>Bootstrap’s jumbotron: <a href="http://getbootstrap.com/components/#jumbotron">http://getbootstrap.com/components/#jumbotron</a></li> <li>Bootstrap’s forms: <a href="http://getbootstrap.com/css/#forms">http://getbootstrap.com/css/#forms</a></li> </ul> <h4 id="only-static-html5-and-style">Only static html5 and style</h4> <p>Add a static jumbotron, an input box and a button to <code class="highlighter-rouge">/app/templates/index.hbs</code>.</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"jumbotron text-center"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Coming Soon<span class="nt">&lt;/h1&gt;</span>

  <span class="nt">&lt;br/&gt;&lt;br/&gt;</span>

  <span class="nt">&lt;p&gt;</span>Don't miss our launch date, request an invitation now.<span class="nt">&lt;/p&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-horizontal form-group form-group-lg row"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-xs-10 col-xs-offset-1 col-sm-6 col-sm-offset-1 col-md-5 col-md-offset-2"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Please type your e-mail address."</span> <span class="na">autofocus=</span><span class="s">"autofocus"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-4 col-md-3"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-primary btn-lg btn-block"</span><span class="nt">&gt;</span>Request invitation<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  
  <span class="nt">&lt;br/&gt;&lt;br/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <h4 id="requirements">Requirements</h4> <p>We would like to cover the following requirements:</p> <ul> <li>“Invite me” button should be inactive when input box is empty.</li> <li>“Invite me” button should be inactive when the content in the input box is not a valid email address.</li> <li>Show a response message after clicking on “Invite me” button.</li> <li>Clear the input box after invitation has sent.</li> </ul> <h4 id="isdisabled">isDisabled</h4> <p>We can add dynamic values to standard html properties using conditionals. We can use our controller to add or modify the value of a variable, which we use in our template. Check the following solution.</p> <p>We use a boolean variable, let’s call it <code class="highlighter-rouge">isDisabled</code>, which will help us to turn on and off the <code class="highlighter-rouge">disabled</code> html attribute on our button. We have access to these variables in our controllers and in our templates.</p> <p>From the official guide: “Each template has an associated controller: this is where the template finds the properties that it displays. You can display a property from your controller by wrapping the property name in curly braces.”</p> <p>First, update your <code class="highlighter-rouge">index.hbs</code> template with this variable.</p> <p>Add <code class="highlighter-rouge">disabled</code> property with <code class="highlighter-rouge"><span class="p">{</span><span class="err">{isDisabled</span><span class="p">}</span><span class="err">}</span></code> boolean variable.</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">disabled=</span><span class="s">{{isDisabled}}</span> <span class="na">class=</span><span class="s">"btn btn-primary btn-lg btn-block"</span><span class="nt">&gt;</span>Request invitation<span class="nt">&lt;/button&gt;</span>
</code></pre></div> <p>Now we can create our index controller:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g controller index
</code></pre></div> <ul> <li>Read more about Ember controllers here: <a href="http://guides.emberjs.com/v2.8.0/controllers/">http://guides.emberjs.com/v2.8.0/controllers/</a></li> </ul> <p>Note: Ember.js still uses controllers, however there were rummors, that the controller layer will be deprecated and removed from Ember.js 3.0. It looks, controllers will stay with us for a while, so don’t worry too much. We use controllers to practice some interesting features, but later we will refactor our app and we will move most of the logic inside components.</p> <p>Add <code class="highlighter-rouge">isDisabled</code> property to the controller. Default value is <code class="highlighter-rouge">true</code>.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">//app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">isDisabled</span><span class="p">:</span> <span class="kc">true</span>

<span class="p">});</span>
</code></pre></div> <p>If you check your app, you will see that the button is disabled by default. We want to add some logic around this feature. We have to learn a couple of new Ember.js features for that.</p> <h4 id="computed-properties-and-observers">Computed Properties and Observers</h4> <p>Computed Properties and Observers are important features of Ember.js. Please read more about it in the official guide first.</p> <ul> <li>Computed Properties: <a href="http://guides.emberjs.com/v2.8.0/object-model/computed-properties/">http://guides.emberjs.com/v2.8.0/object-model/computed-properties/</a></li> <li>Observers: <a href="http://guides.emberjs.com/v2.8.0/object-model/observers/">http://guides.emberjs.com/v2.8.0/object-model/observers/</a></li> </ul> <p>Please note, I will use the new, preferred syntax in our project. You could ask, was there some other syntax before? Yes.</p> <p>Computed properties and observers still could be written in two ways, however the classic syntax will be deprecated soon, but it is important to know the “old” syntax and the “new” syntax, so when you see older project, you will recognise this pattern.</p> <p>Previously <code class="highlighter-rouge">.property()</code> and <code class="highlighter-rouge">.observes()</code> were attached to the end of the functions. Nowadays we use <code class="highlighter-rouge">Ember.computed()</code> and <code class="highlighter-rouge">Ember.observer()</code> functions instead. Let’s see in examples.</p> <p>Old (with ES5 string concatenation):</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">//...</span>
<span class="nl">fullName</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">);</span>
<span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">,</span> <span class="s1">'lastName'</span><span class="p">)</span>
<span class="c1">//...</span>
</code></pre></div> <p>New (with ES6 string interpolation, which uses back-tick, dollar sign and curly braces):</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">//...</span>
<span class="nl">fullName</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">,</span> <span class="s1">'lastName'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">)}</span> <span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">)}</span><span class="err">`</span><span class="p">;</span>
<span class="p">})</span>
<span class="c1">//...</span>
</code></pre></div> <p>So, we will use this new syntax. <code class="highlighter-rouge">Ember.computed()</code> can have more parameters. The first parameters are always variables/properties in string format; what we would like to use inside our function. The last parameter is a <code class="highlighter-rouge">function()</code>. Inside this function we will have access to the properties with <code class="highlighter-rouge">this.get()</code>. In Ember.js we read properties with <code class="highlighter-rouge">this.get('propertyName')</code> and update properties with <code class="highlighter-rouge">this.set('propertyName', newValue)</code>.</p> <p>Back to our project–let’s play with these new features.</p> <p>Let’s update our html code with input component syntax and add a <code class="highlighter-rouge">value</code> to our email input box.</p> <p>Modify <code class="highlighter-rouge">&lt;input&gt;</code> line as follow in <code class="highlighter-rouge">index.hbs</code>:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"email"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">emailAddress</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"Please type your e-mail address."</span> <span class="nv">autofocus</span><span class="o">=</span><span class="s2">"autofocus"</span><span class="k">}}</span>
</code></pre></div> <p>As you can see, we use the <code class="highlighter-rouge">emailAddress</code> variable, or in other words, a “property” where we would like to store the value of the input box.</p> <p>If you type something in the input box, it will update this variable in the controller as well.</p> <p>You can use the following code in your controller to demonstrate the differences between computed properties and observers:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">//app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">isDisabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>

  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">actualEmailAddress</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="err"> </span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'actualEmailAddress function is called: '</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">));</span>
  <span class="p">}),</span>

  <span class="na">emailAddressChanged</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">observer</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="err"> </span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'observer is called'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">));</span><span class="err"> </span>
  <span class="p">})</span>

<span class="p">});</span>

</code></pre></div> <p>Observers will always be called when the value of the <code class="highlighter-rouge">emailAddress</code> changes, while the computed property only changes when you go and use that property. Open your app in your browser, and activate Ember Inspector. Click on <code class="highlighter-rouge">/# Routes</code> section, find the <code class="highlighter-rouge">index</code> route, and in the same line, under the <code class="highlighter-rouge">Controller</code> column, you will see an <code class="highlighter-rouge">&gt;$E</code> sign; click on it. Open the console in Chrome and you will see something like this: <code class="highlighter-rouge">Ember Inspector ($E): Class {__nextSuper: undefined, __ember_meta__: Object, __ember1442491471913: "ember443"}</code></p> <p>If you type the following in the console: <code class="highlighter-rouge">$E.get('actualEmailAddress')</code>, you should see the <code class="highlighter-rouge">console.log</code> output message defined above inside “actualEmailAddress”. You can try out <code class="highlighter-rouge">$E.set('emailAddress', 'example@example.com')</code> in the console. What do you see?</p> <p>Please play with the above examples and try to create your own observers and computed properties.</p> <h4 id="isdisabled-with-computed-property">isDisabled with Computed Property</h4> <p>We can rewrite our <code class="highlighter-rouge">isDisabled</code> with computed property as well.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">)</span> <span class="o">===</span> <span class="s1">''</span><span class="p">;</span>
  <span class="p">})</span>

<span class="p">});</span>
</code></pre></div> <p>There are a few predefined computed property functions, which saves you some code. In the following example we use <code class="highlighter-rouge">Ember.computed.empty()</code>, which checks whether a property is empty or not.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">)</span>

<span class="p">});</span>
</code></pre></div> <p>Try out the above example in your code.</p> <ul> <li>More about <code class="highlighter-rouge">Ember.computed</code> short syntax: <a href="http://emberjs.com/api/classes/Ember.computed.html">http://emberjs.com/api/classes/Ember.computed.html</a> (Check all the methods on that page.)</li> </ul> <h4 id="isvalid">isValid</h4> <p>Let’s go further. It would be a more elegant solution if we only enabled our “Request Invitation” button when the input box contained a valid email address.</p> <p>We’ll use the <code class="highlighter-rouge">Ember.computed.match()</code> short computed property function to check the validity of the string. But <code class="highlighter-rouge">isDisabled</code> needs to be the negated version of this <code class="highlighter-rouge">isValid</code> computed property. We can use the <code class="highlighter-rouge">Ember.computed.not()</code> for this.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="sr">/^.+@.+</span><span class="se">\.</span><span class="sr">.+$/</span><span class="p">),</span>
  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">'isValid'</span><span class="p">)</span>

<span class="p">});</span>
</code></pre></div> <p>Great, it works now as expected. You see, we can write really elegant code with Ember.js, can’t we? ;)</p> <h4 id="adding-our-first-action">Adding our first Action</h4> <p>Great we have an input box and a button on our screen, but it does nothing at the moment. Let’s implement our first action.</p> <p>Update the <code class="highlighter-rouge">&lt;button&gt;</code> line in <code class="highlighter-rouge">index.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-primary btn-lg btn-block"</span> <span class="na">disabled=</span><span class="k">{{</span><span class="nv">isDisabled</span><span class="k">}}</span><span class="err"> </span><span class="k">{{</span><span class="nv">action</span> <span class="s1">'saveInvitation'</span><span class="k">}}</span><span class="err">&gt;</span><span class="s">Request</span> <span class="na">invitation</span><span class="err">&lt;/</span><span class="na">button</span><span class="nt">&gt;</span>
</code></pre></div> <p>You can try it out in your browser and see that if you click on the button, you will get a nice error message, alerting you that you have to implement this action in your controller. Let’s do that.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="sr">/^.+@.+</span><span class="se">\.</span><span class="sr">.+$/</span><span class="p">),</span>
  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">'isValid'</span><span class="p">),</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveInvitation</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">alert</span><span class="p">(</span><span class="err">`</span><span class="nx">Saving</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">following</span> <span class="nx">email</span> <span class="nx">address</span> <span class="nx">is</span> <span class="k">in</span> <span class="na">progress</span><span class="p">:</span> <span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">)}</span><span class="err">`</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'responseMessage'</span><span class="p">,</span> <span class="err">`</span><span class="nx">Thank</span> <span class="nx">you</span><span class="o">!</span> <span class="nx">We</span><span class="s1">'ve just saved your email address: ${this.get('</span><span class="nx">emailAddress</span><span class="s1">')}`);
      this.set('</span><span class="nx">emailAddress</span><span class="s1">', '</span><span class="err">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">});</span>
</code></pre></div> <p>If you click on the button, the <code class="highlighter-rouge">saveInvitation</code> action is called and shows an alert box, sets up a <code class="highlighter-rouge">responseMessage</code> property, and finally deletes the content of <code class="highlighter-rouge">emailAddress</code>.</p> <p>We have to show the response message. Extend your template.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/index.hbs --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"jumbotron text-center"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;h1&gt;</span>Coming Soon<span class="nt">&lt;/h1&gt;</span>

   <span class="nt">&lt;br/&gt;&lt;br/&gt;</span>

   <span class="nt">&lt;p&gt;</span>Don't miss our launch date, request an invitation now.<span class="nt">&lt;/p&gt;</span>

   <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-horizontal form-group form-group-lg row"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-xs-10 col-xs-offset-1 col-sm-6 col-sm-offset-1 col-md-5 col-md-offset-2"</span><span class="nt">&gt;</span>
       <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"email"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">emailAddress</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"Please type your e-mail address."</span> <span class="nv">autofocus</span><span class="o">=</span><span class="s2">"autofocus"</span><span class="k">}}</span>
     <span class="nt">&lt;/div&gt;</span>
     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-4 col-md-3"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-primary btn-lg btn-block"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'saveInvitation'</span><span class="k">}}</span> <span class="na">disabled=</span><span class="k">{{</span><span class="nv">isDisabled</span><span class="k">}}</span><span class="err">&gt;</span><span class="s">Request</span> <span class="na">invitation</span><span class="err">&lt;/</span><span class="na">button</span><span class="nt">&gt;</span>
     <span class="nt">&lt;/div&gt;</span>
   <span class="nt">&lt;/div&gt;</span>

   <span class="k">{{#if</span> <span class="nv">responseMessage</span><span class="k">}}</span>
     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-success"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">responseMessage</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
   <span class="k">{{/if}}</span>

   <span class="nt">&lt;br/&gt;&lt;br/&gt;</span>

<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>We use the <code class="highlighter-rouge"><span class="p">{</span><span class="err">{#if</span><span class="p">}</span><span class="err">}</span><span class="p">{</span><span class="err">{/if</span><span class="p">}</span><span class="err">}</span></code> handlebar helper block to show or hide the alert message. Handlebar conditionals are really powerful. You can use <code class="highlighter-rouge"><span class="p">{</span><span class="err">{else</span><span class="p">}</span><span class="err">}</span></code> as well.</p> <ul> <li>More about conditionals in templates: <a href="http://guides.emberjs.com/v2.8.0/templates/conditionals/">http://guides.emberjs.com/v2.8.0/templates/conditionals/</a></li> </ul> <p>Brilliant. You learned a lot about Ember.js and you have just implemented these great features.</p> <h3 id="homework-1">Homework</h3> <p>It is time to practice what you have just learned.</p> <p>You already have an amazing <code class="highlighter-rouge">Contact</code> page, where we would like to add a contact form. In this contact form will be two fields. One field for an email address and one field for a text message. And there will be a “Send message” button. This button should be active only if the email address field isn’t empty and is valid and there is some message in the text box. After clicking on the “Send message” button, an alert should appear with the email address and the message. When you close the alert message, the form should be cleared and a success message should appear on the page in a green box. This message could be something like, “We got your message and we’ll get in touch soon”.</p> <p>Hint: you already have a <code class="highlighter-rouge">contact.hbs</code> template but you need a controller for it where you manage its logic.</p> <p>Bonus point if you can add validation to the <code class="highlighter-rouge">textarea</code>. One option: the textarea should not be empty. Another option: the length of the message has to be at least 5 characters long.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="k">{{</span><span class="nv">textarea</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"Your message. (At least 5 characters.)"</span> <span class="nv">rows</span><span class="o">=</span><span class="s2">"7"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">message</span><span class="k">}}</span>
</code></pre></div> <p>Short version of computed property for <code class="highlighter-rouge">greater than or equal</code>:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="s1">'yourProperty'</span><span class="p">,</span> <span class="nx">number</span><span class="p">)</span>
</code></pre></div> <p>(Please note, it is <code class="highlighter-rouge">computed.gte</code> and not <code class="highlighter-rouge">computed.get</code>.)</p> <p>If you have two computed properties, and both must be <code class="highlighter-rouge">true</code>, you can use a third computed property to compute the <code class="highlighter-rouge">and</code>.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="s1">'firstComputedProperty'</span><span class="p">,</span> <span class="s1">'secondComputedProperty'</span><span class="p">)</span>
</code></pre></div> <p>You can get a string computed property length with <code class="highlighter-rouge">.length</code>. If your computed property is <code class="highlighter-rouge">message</code>, the length of that message is <code class="highlighter-rouge">message.length</code>.</p> <ul> <li>In terms of feedback on a form, there is a really cool solution on bootstrap: <a href="http://getbootstrap.com/css/#forms-control-validation">http://getbootstrap.com/css/#forms-control-validation</a> (Check the “With optional icons” section.)</li> </ul> <p>Please try to implement the above requirements. When you’re finished, you can check out my repository (the contact logic in my repository is already located at <code class="highlighter-rouge">library-app/app/models/contact.js</code> because of how we refactor things later, however you can see in this earlier commit, that validation was <a href="https://github.com/zoltan-nz/library-app/blob/60ab93f51e8f488cde6c2e52d28a978370323858/app/controllers/contact.js">placed in the controller</a>). I am pretty sure that your solution will be much better than mine. ;)</p> <h2 id="lesson-3"><a name="lesson-3"></a>Lesson 3</h2> <h3 id="our-first-emberjs-model">Our first Ember.js Model</h3> <p>We ask for email addresses on the home page, but we don’t save them in the database at the moment. It is time to implement this feature in our website.</p> <ul> <li>Please read the detailed introduction on Ember.js website about Ember.js Models: <a href="http://guides.emberjs.com/v2.8.0/models/">http://guides.emberjs.com/v2.8.0/models/</a></li> </ul> <p>Let’s create our first model where we save email addresses for invitation. Type the following command in your command line.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g model invitation email:string
</code></pre></div> <p>Hope you read about <code class="highlighter-rouge">store</code> in the official Guide. Let’s use it.</p> <p>Update your <code class="highlighter-rouge">app/controllers/index.js</code> controller action. Instead of showing a useless alert message, we try to save our data.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">headerMessage</span><span class="p">:</span> <span class="s1">'Coming Soon'</span><span class="p">,</span>
  <span class="na">responseMessage</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="sr">/^.+@.+</span><span class="se">\.</span><span class="sr">.+$/</span><span class="p">),</span>
  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">'isValid'</span><span class="p">),</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveInvitation</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">);</span>

      <span class="kr">const</span> <span class="nx">newInvitation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'invitation'</span><span class="p">,</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="nx">email</span> <span class="p">});</span>
      <span class="nx">newInvitation</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'responseMessage'</span><span class="p">,</span> <span class="err">`</span><span class="nx">Thank</span> <span class="nx">you</span><span class="o">!</span> <span class="nx">We</span> <span class="nx">have</span> <span class="nx">just</span> <span class="nx">saved</span> <span class="nx">your</span> <span class="nx">email</span> <span class="na">address</span><span class="p">:</span> <span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">)}</span><span class="err">`</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span> 
</code></pre></div> <p>Open the app in your browser, and open the browser’s console. Try to save an invitation email address on the home page. You will see an error message in the console.</p> <p>Ember.js tried to send that data to a server, but we don’t have a server yet. Let’s build one.</p> <h3 id="setup-a-server-on-firebase">Setup a server on Firebase</h3> <p>(Google’s Firebase service is recently updated, this section already covers the latest version.)</p> <p>Firebase is a server and API service. Very easy to use. <a href="http://firebase.google.com">http://firebase.google.com</a></p> <ol> <li>Create an account.</li> <li>You can read the latest Readme on EmberFire website: <a href="https://github.com/firebase/emberfire">https://github.com/firebase/emberfire</a> (You can find the earlier version’s guide and help section here: <a href="https://www.firebase.com/docs/web/libraries/ember/guide.html">https://www.firebase.com/docs/web/libraries/ember/guide.html</a>)</li> <li>First, run the following command in your terminal: <code class="highlighter-rouge">ember install emberfire</code></li> <li>You will see instructions in the console. We have to manually add a few lines to our configuration file. Copy and paste those lines in <code class="highlighter-rouge">config/environment.js</code>. (Please note you may have to update a few single quotes to double-quotes in <code class="highlighter-rouge">contentSecurityPolicy</code>, check my code snippet below, double-quotes are corrected there.)</li> <li>Go back to Firebase and create an app there. When your new firebase database ready, click on the purple icon on Overview page (“Add Firebase to your web app”). Check those params in the popup window (“apiKey”, “authDomain”, etc.) and copy-paste the values in your <code class="highlighter-rouge">config/environment.js</code> file in your Ember application accordingly.</li> </ol> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// config/environment.js</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">environment</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ENV</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">modulePrefix</span><span class="p">:</span> <span class="s1">'library-app'</span><span class="p">,</span>
    <span class="na">environment</span><span class="p">:</span> <span class="nx">environment</span><span class="p">,</span>
    <span class="na">baseURL</span><span class="p">:</span> <span class="s1">'/'</span><span class="p">,</span>
    <span class="na">locationType</span><span class="p">:</span> <span class="s1">'auto'</span><span class="p">,</span>

    <span class="na">firebase</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'xyz'</span><span class="p">,</span>
      <span class="na">authDomain</span><span class="p">:</span> <span class="s1">'YOUR-FIREBASE-APP.firebaseapp.com'</span><span class="p">,</span>
      <span class="na">databaseURL</span><span class="p">:</span> <span class="s1">'https://YOUR-FIREBASE-APP.firebaseio.com'</span><span class="p">,</span>
      <span class="na">storageBucket</span><span class="p">:</span> <span class="s1">'YOUR-FIREBASE-APP.appspot.com'</span><span class="p">,</span>
    <span class="p">},</span>

    <span class="c1">// if using ember-cli-content-security-policy</span>
    <span class="na">contentSecurityPolicy</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">'script-src'</span><span class="p">:</span> <span class="s2">"'self' 'unsafe-eval' apis.google.com"</span><span class="p">,</span>
      <span class="s1">'frame-src'</span><span class="p">:</span> <span class="s2">"'self' https://*.firebaseapp.com"</span><span class="p">,</span>
      <span class="s1">'connect-src'</span><span class="p">:</span> <span class="s2">"'self' wss://*.firebaseio.com https://*.googleapis.com"</span>
    <span class="p">},</span>


    <span class="na">EmberENV</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">FEATURES</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span>
</code></pre></div> <p>Please note, that Firebase closes the database by default, you have to manually add permissions. Please read <a href="https://firebase.google.com/docs/database/security/quickstart">this section on Firebase website</a>.</p> <p>Change your database public, so we don’t have to implement authentication in this stage. Navigate to your Firebase Console, choose your new app, select “Database” from the left menu and click on “Rules” tab. Change the content in the rules editor:</p> <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">".read"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">".write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> <p>Try out Request Invitation button again, check the browser’s console messages and open the Firebase website, and check your app dashboard. You will see, that the email address, what you just saved on your home page, is sent to Firebase and it is saved on the server.</p> <ul> <li>Remember to restart your Ember server, or else you’ll have problems with the newly installed EmberFire addon.</li> </ul> <p>Well done!</p> <h3 id="promise-and-the--context-in-javascript--playing-with-es5-and-es6-a-little">Promise and the <code class="highlighter-rouge">this</code> context in javascript (+ playing with ES5 and ES6 a little)</h3> <p>Promises are a unique asynchronous feature in javascript. Basically, they’re objects that haven’t completed yet, but are expected to in the future. You can read more about promises on the Mozilla website: <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise">https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise</a></p> <p>In our code, we use a Promise: <code class="highlighter-rouge">.save()</code></p> <p>The <code class="highlighter-rouge">save</code> method on Ember Data Model is a <code class="highlighter-rouge">Promise</code>. It promises us that it is trying to save our data. It could be successful or maybe return with an error.</p> <p>We can catch the result of a <code class="highlighter-rouge">Promise</code> with a chained <code class="highlighter-rouge">.then()</code>. In our example:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">newInvitation</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Email address is saved.'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div> <p>If the saving process is successful, ‘fulfilled’, then we will get back a response from the server, which we can catch in our function parameter.</p> <p>We have to relocate the code that displays our success message to be inside this new function, because we would like to show the success message only when the data is actually saved.</p> <p>If you simply copy and paste the snippet below (which uses ES5 JavaScript syntax), you will see that the code does not work as expected. (In the following snippet, I mix the ES5 <code class="highlighter-rouge">function</code> and ES6 string interpolation syntax. It is not nice.)</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">newInvitation</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'responseMessage'</span><span class="p">,</span> <span class="err">`</span><span class="nx">Thank</span> <span class="nx">you</span><span class="o">!</span> <span class="nx">We</span> <span class="nx">have</span> <span class="nx">just</span> <span class="nx">saved</span> <span class="nx">your</span> <span class="nx">email</span> <span class="nx">address</span><span class="err">:</span> <span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">)}</span><span class="err">`</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div> <p>In javascript, <code class="highlighter-rouge">this</code> always points to the object that wraps around it. In the above example, <code class="highlighter-rouge">this</code> will be undefined because we are inside the function after the Promise. Please learn more about it here: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this</a></p> <p>This kind of problem is solved nicely in ES6/ES2015, the new JavaScript, which is what I mainly use in this tutorial. However, it’s not a problem if you see the old, traditional way also. We’ll look at it for just a second.</p> <p>In ES5 syntax, we have to save the controller context (the controller’s <code class="highlighter-rouge">this</code>) in a local variable. We can set the controller’s <code class="highlighter-rouge">this</code> as the variable <code class="highlighter-rouge">_that</code> so we can use it inside our <code class="highlighter-rouge">then</code>.</p> <p>In ES5 syntax our controller would look like this. (You don’t have to use this code in your project. I will show the preferred ES6/ES2015 version after this.)</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="na">headerMessage</span><span class="p">:</span> <span class="s1">'Coming Soon'</span><span class="p">,</span>
    <span class="na">responseMessage</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

    <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="sr">/^.+@.+</span><span class="se">\.</span><span class="sr">.+$/</span><span class="p">),</span>
    <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">'isValid'</span><span class="p">),</span>

    <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

        <span class="na">saveInvitation</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="kd">var</span> <span class="nx">_that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">email</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">newInvitation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'invitation'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">email</span><span class="p">:</span> <span class="nx">email</span>
            <span class="p">});</span>

            <span class="nx">newInvitation</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_that</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'responseMessage'</span><span class="p">,</span> <span class="s2">"Thank you! We saved your email address with the following id: "</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'id'</span><span class="p">));</span>
                <span class="nx">_that</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>We save the <code class="highlighter-rouge">this</code> controller context in a <code class="highlighter-rouge">_that</code> local variable. We use this local variable inside our function after the <code class="highlighter-rouge">save()</code> Promise. The above example uses the <code class="highlighter-rouge">response</code> from Firebase and shows the <code class="highlighter-rouge">id</code> of the generated database record. This methods uses the <code class="highlighter-rouge">var</code> declaration a lot, but in ES2015 JavaScript, we don’t use <code class="highlighter-rouge">var</code> anymore; only <code class="highlighter-rouge">let</code> and <code class="highlighter-rouge">const</code>. Good bye <code class="highlighter-rouge">var</code> and goodbye <code class="highlighter-rouge">_that</code> also. ;)</p> <p>Let’s look at the cleaner ES2015 version. (You can use this code in your project.)</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">headerMessage</span><span class="p">:</span> <span class="s1">'Coming Soon'</span><span class="p">,</span>
  <span class="na">responseMessage</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">emailAddress</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="sr">/^.+@.+</span><span class="se">\.</span><span class="sr">.+$/</span><span class="p">),</span>
  <span class="na">isDisabled</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">'isValid'</span><span class="p">),</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveInvitation</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">);</span>

      <span class="kr">const</span> <span class="nx">newInvitation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'invitation'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">email</span><span class="p">:</span> <span class="nx">email</span>
      <span class="p">});</span>

      <span class="nx">newInvitation</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'responseMessage'</span><span class="p">,</span> <span class="err">`</span><span class="nx">Thank</span> <span class="nx">you</span><span class="o">!</span> <span class="nx">We</span> <span class="nx">saved</span> <span class="nx">your</span> <span class="nx">email</span> <span class="nx">address</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">following</span> <span class="na">id</span><span class="p">:</span> <span class="nx">$</span><span class="p">{</span><span class="nx">response</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)}</span><span class="err">`</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'emailAddress'</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
      <span class="p">});</span>

    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">});</span>
</code></pre></div> <p>You can see the new <code class="highlighter-rouge">=&gt;</code> syntax here. We don’t need to use the <code class="highlighter-rouge">function</code> keyword so much. The context of the <code class="highlighter-rouge">saveInvitation()</code> method is automatically passed deeper, into our asynchronous callback function. Now you can just use a simple <code class="highlighter-rouge">this</code>. Much nicer and cleaner. Do you like it?</p> <p>After <code class="highlighter-rouge">save()</code>, the model from the server will be sent to the callback as <code class="highlighter-rouge">response</code>. This model object will contain the <code class="highlighter-rouge">id</code> of our model. The <code class="highlighter-rouge">id</code> comes from our database. You can use it in the response message.</p> <p>Great, our home page is ready.</p> <h3 id="create-an-admin-page">Create an Admin page</h3> <p>We would like to list out from the database the persisted email addresses.</p> <p>Let’s create a new route and page what we can reach with the following url: <code class="highlighter-rouge">http://localhost:4200/admin/invitations</code></p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g route admin/invitations
</code></pre></div> <p>Add this new page to the <code class="highlighter-rouge">navbar.hbs</code> with a dropdown.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/navbar.hbs --&gt;</span>
<span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"navbar navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"navbar-header"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"navbar-toggle collapsed"</span> <span class="na">data-toggle=</span><span class="s">"collapse"</span> <span class="na">data-target=</span><span class="s">"#main-navbar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Toggle navigation<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;/button&gt;</span>
      <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"navbar-brand"</span><span class="k">}}</span>Library App<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"main-navbar"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
        <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'about'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'contact'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
      <span class="nt">&lt;/ul&gt;</span>

      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"dropdown"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"dropdown-toggle"</span> <span class="na">data-toggle=</span><span class="s">"dropdown"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-haspopup=</span><span class="s">"true"</span> <span class="na">aria-expanded=</span><span class="s">"false"</span><span class="nt">&gt;</span>
            Admin<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"caret"</span><span class="nt">&gt;&lt;/span&gt;</span>
          <span class="nt">&lt;/a&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"dropdown-menu"</span><span class="nt">&gt;</span>
          <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'admin.invitations'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Invitations<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
          <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.navbar-collapse --&gt;</span>
  <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.container-fluid --&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</code></pre></div> <p>Add a table to <code class="highlighter-rouge">app/templates/admin/invitations.hbs</code></p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/admin/invitations.hbs --&gt;</span>

<span class="nt">&lt;h1&gt;</span>Invitations<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-bordered table-striped"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>ID<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>E-mail<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
  <span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">invitation</span><span class="err">|</span><span class="k">}}</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span><span class="k">{{</span><span class="nv">invitation</span><span class="p">.</span><span class="nv">id</span><span class="k">}}</span><span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;td&gt;</span><span class="k">{{</span><span class="nv">invitation</span><span class="p">.</span><span class="nv">email</span><span class="k">}}</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div> <p>We use the <code class="highlighter-rouge"><span class="p">{</span><span class="err">{#each</span><span class="p">}</span><span class="err">}</span><span class="p">{</span><span class="err">{/each</span><span class="p">}</span><span class="err">}</span></code> handlebar block helper to generate a list. The <code class="highlighter-rouge">model</code> variable will contain an array of invitations which we will retrieve from the server. Ember.js automatically populates responses from the server, however we have not implemented this step yet.</p> <p>Let’s retrieve our data from the server using a Route Handler and Ember Data.</p> <ul> <li>Please start here and read the official guide about Route’s Model: <a href="http://guides.emberjs.com/v2.8.0/routing/specifying-a-routes-model/">http://guides.emberjs.com/v2.8.0/routing/specifying-a-routes-model/</a></li> </ul> <p>Add the following code to your <code class="highlighter-rouge">app/routes/admin/invitations.js</code> file:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/admin/invitations.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'invitation'</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">});</span>
</code></pre></div> <p>Launch your app and check your table in Admin. What do you think? :)</p> <h3 id="crud-interface-for-libraries">CRUD interface for libraries</h3> <p>We will implement a new section in our app, where we can create new libraries and list the previously created data.</p> <p>Firstly we create our <code class="highlighter-rouge">library</code> model.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g model library name:string address:string phone:string
</code></pre></div> <p>Secondly we create our new route. At the moment we’ll do it without Ember CLI; just manually add the following lines to our <code class="highlighter-rouge">router.js</code>:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/router.js</span>

<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">config</span> <span class="nx">from</span> <span class="s1">'./config/environment'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">location</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">locationType</span>
<span class="p">});</span>

<span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'about'</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'invitations'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'new'</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Router</span><span class="p">;</span>
</code></pre></div> <p>Now we create 3 new templates. Our main <code class="highlighter-rouge">libraries.hbs</code>, a <code class="highlighter-rouge">libraries/index.hbs</code> for displaying the list, and a <code class="highlighter-rouge">libraries/new.hbs</code> for a library creation form.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g template libraries
$ ember g template libraries/index
$ ember g template libraries/new
</code></pre></div> <p>Update your <code class="highlighter-rouge">navbar.hbs</code> main navigation section as follows.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/navbar.hbs --&gt;</span>
<span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'libraries'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Libraries<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'about'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
  <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'contact'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div> <p>Add a submenu to <code class="highlighter-rouge">libraries.hbs</code></p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/libraries.hbs --&gt;</span>
<span class="nt">&lt;h1&gt;</span>Libraries<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"well"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav nav-pills"</span><span class="nt">&gt;</span>
    <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'libraries.index'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>List all<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
    <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'libraries.new'</span> <span class="nv">tagName</span><span class="o">=</span><span class="s2">"li"</span><span class="k">}}</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Add new<span class="nt">&lt;/a&gt;</span><span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="k">{{</span><span class="nv">outlet</span><span class="k">}}</span>
</code></pre></div> <p>Check your app; you should see a new menu item, and a submenu with two items under <code class="highlighter-rouge">/libraries</code>.</p> <p>The other two templates should have the following content.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/libraries/index.hbs --&gt;</span>
<span class="nt">&lt;h2&gt;</span>List<span class="nt">&lt;/h2&gt;</span>

<span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">library</span><span class="err">|</span><span class="k">}}</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel panel-default"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"panel-title"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span><span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-body"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p&gt;</span>Address: <span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">address</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;p&gt;</span>Phone: <span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">phone</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
</code></pre></div> <p>We generate a list from our model which will be retrieved in the route. We are using <code class="highlighter-rouge">panel</code> style from bootstrap here.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/libraries/new.hbs --&gt;</span>
<span class="nt">&lt;h2&gt;</span>Add a new local Library<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-horizontal"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">name</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The name of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Address<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">address</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The address of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Phone<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">phone</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The phone number of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-offset-2 col-sm-10"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-default"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'saveLibrary'</span> <span class="nv">model</span><span class="k">}}</span><span class="nt">&gt;</span>Add to library list<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>We use <code class="highlighter-rouge">model</code> as our value store. You will soon see that our model will be created in the route. The action attached to the submit button will call a <code class="highlighter-rouge">saveLibrary</code> function that we’ll pass the <code class="highlighter-rouge">model</code> parameter to.</p> <p>In your <code class="highlighter-rouge">app/routes</code> folder create <code class="highlighter-rouge">libraries</code> folder and add two js files: <code class="highlighter-rouge">index.js</code> and <code class="highlighter-rouge">new.js</code></p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'library'</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">});</span>
</code></pre></div> <p>In the route above, we retrieve all the library records from the server.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/new.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'library'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveLibrary</span><span class="p">(</span><span class="nx">newLibrary</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">newLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="nx">willTransition</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// rollbackAttributes() removes the record from the store</span>
      <span class="c1">// if the model 'isNew'</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'model'</span><span class="p">).</span><span class="nx">rollbackAttributes</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>In the above route’s model method, we create a new record and that will be the <code class="highlighter-rouge">model</code>. It automatically appears in the controller and in the template. In the <code class="highlighter-rouge">saveLibrary</code> action we accept a parameter and we save that model, and then we send the application back to the Libraries home page with <code class="highlighter-rouge">transitionTo</code>.</p> <p>There is a built-in Ember.js action (event) called <code class="highlighter-rouge">willTransition</code> that is called when you leave a page (route). In our case, we use this action to reset the model if we haven’t saved it in the database yet.</p> <p>As you can see, we can access the controller from the route handler using <code class="highlighter-rouge">this.controller</code>, however we don’t have a real controller file for this route (<code class="highlighter-rouge">/libraries/new.js</code>). Ember.js’s dynamic code generation feature automatically creates controllers and route handlers for each route. They exists in memory. In this example, the <code class="highlighter-rouge">model</code> property exists in this “virtual” controller and in our template, so we can still “destroy” it.</p> <p>Open your browser and please check out these automatically generated routes and controllers in Ember Inspector, under the “Routes” section. You will see how many different elements are dynamically created.</p> <p>What is that nice one liner in our <code class="highlighter-rouge">saveLibrary()</code> method?</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">newLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>
</code></pre></div> <p>In ES2015, with the <code class="highlighter-rouge">=&gt;</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#Syntax">syntax</a>, if we only have one line of code (like <code class="highlighter-rouge">return</code> + something) we can use a cleaner structure, without curly braces and <code class="highlighter-rouge">return</code>.</p> <p>Update: In a previous version we had the following code in <code class="highlighter-rouge">willTransition()</code>.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">willTransition</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'model'</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'isNew'</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">destroyRecord</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>Thanks for Kiffin’s <a href="#disqus_thread">comment</a>, we have a simpler solution. Using <code class="highlighter-rouge">rollbackAttributes()</code> is cleaner. It destroys the record automatically if it is new.</p> <h3 id="homework-2">Homework</h3> <p><strong>Option 1:</strong> Further improve your Contact Page.</p> <ol> <li>Create a <code class="highlighter-rouge">contact</code> model with <code class="highlighter-rouge">email</code> and <code class="highlighter-rouge">message</code> fields.</li> <li>Save the model on the server when someone clicks on the “Send” button on the Contact form. Update your <code class="highlighter-rouge">contact.js</code> controller to contain validations and actions.</li> <li>Create an Admin page under <code class="highlighter-rouge">http://localhost:4200/admin/contacts</code></li> <li>List all saved messages in a table.</li> </ol> <p><strong>Option 2:</strong> Refactor your app’s contact section with usage of model in route.</p> <ol> <li>Move contact validation into the contact model.</li> <li>Copy and paste the actions from the controller to the route and try sending a message. Why don’t the message and email boxes clear? Refactor it so they do clear. You’ll also need to correct the same problem in the validation code you moved to the contact model.</li> <li>Remove the contact controller.</li> </ol> <h2 id="lesson-4"><a name="lesson-4"></a>Lesson 4</h2> <h3 id="deploy-your-app-using-firebase-hosting-service">Deploy your app using Firebase Hosting service</h3> <p>Follow the <a href="https://firebase.google.com/docs/hosting/quickstart">guide on Firebase</a>:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ npm install -g firebase-tools
$ ember build --prod
$ firebase login
$ firebase init
</code></pre></div> <p>Questions and answers:</p> <ul> <li> <p>What Firebase CLI features do you want to setup for this folder? ==&gt; Hosting</p> </li> <li> <p>What Firebase project do you want to associate as default? ==&gt; Select your project.</p> </li> <li> <p>What file should be used for Database Rules? ==&gt; Just accept the <code class="highlighter-rouge">database.rules.json</code> with hitting Return/Enter.</p> </li> <li> <p>What do you want to use as your public directory? ==&gt; Type: <code class="highlighter-rouge">dist</code>, because we would like to publish the content from our <code class="highlighter-rouge">dist</code> folder.</p> </li> <li> <p>Configure as a single-page app (rewrite all urls to /index.html)? ==&gt; Answer: YES (Please note, the default answer would be N, so you have to type YES.)</p> </li> <li> <p>File dist/index.html already exists. Overwrite? ==&gt; NO!!! Accept the default NO.</p> </li> </ul> <p>There is a new <code class="highlighter-rouge">firebase.json</code> file in your project folder, check it out:</p> <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"database"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"rules"</span><span class="p">:</span><span class="w"> </span><span class="s2">"database.rules.json"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"hosting"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"public"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"rewrites"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"**"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/index.html"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> <p>And deploy:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ firebase deploy
</code></pre></div> <p>Check your app.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ firebase open
</code></pre></div> <p>Select <code class="highlighter-rouge">Hosting: Deployed Site</code></p> <p>It’s live! :-D Congratulations!</p> <h3 id="add-delete-edit-button-and-edit-route">Add Delete, Edit button and Edit route</h3> <h4 id="upgrading-the-library-list-view-to-a-grid-view">Upgrading the library list view to a grid view</h4> <p>Let’s upgrade our <code class="highlighter-rouge">app/templates/libraries/index.hbs</code> to show a nice grid layout. We have to tweak our stylesheet a little bit as well. You can see below that there are two buttons in <code class="highlighter-rouge">panel-footer</code>. The first button is a link to the Edit screen, and the second is a Delete button with the action <code class="highlighter-rouge">deleteLibrary</code>. We send <code class="highlighter-rouge">library</code> as a parameter to that action.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/libraries/index.hbs --&gt;</span>
<span class="nt">&lt;h2&gt;</span>List<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">library</span><span class="err">|</span><span class="k">}}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel panel-default library-item"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"panel-title"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span><span class="nt">&lt;/h3&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-body"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;p&gt;</span>Address: <span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">address</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
          <span class="nt">&lt;p&gt;</span>Phone: <span class="k">{{</span><span class="nv">library</span><span class="p">.</span><span class="nv">phone</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-footer text-right"</span><span class="nt">&gt;</span>
          <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'libraries.edit'</span> <span class="nv">library</span><span class="p">.</span><span class="nv">id</span> <span class="nv">class</span><span class="o">=</span><span class="s1">'btn btn-success btn-xs'</span><span class="k">}}</span>Edit<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
          <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-danger btn-xs"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'deleteLibrary'</span> <span class="nv">library</span><span class="k">}}</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nn">#</span> <span class="nt">app</span><span class="o">/</span><span class="nt">styles</span><span class="o">/</span><span class="nt">app</span><span class="nc">.scss</span>
<span class="o">@</span><span class="nt">import</span> <span class="s1">'bootstrap'</span><span class="p">;</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">padding-top</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">html</span> <span class="p">{</span>
  <span class="nl">overflow-y</span><span class="p">:</span> <span class="nb">scroll</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.library-item</span> <span class="p">{</span>
  <span class="nl">min-height</span><span class="p">:</span> <span class="m">150px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div> <p>If you try to launch the app now, you’ll get an error message, because we haven’t implemented the <code class="highlighter-rouge">libraries.edit</code> route or the <code class="highlighter-rouge">deleteLibrary</code> action. Let’s implement these.</p> <h4 id="duplicate-some-code-create-editjs-and-edithbs">Duplicate some code, create edit.js and edit.hbs</h4> <p>Manually add the new <code class="highlighter-rouge">edit</code> route to <code class="highlighter-rouge">router.js</code>. We’ll set up a unique <code class="highlighter-rouge">path:</code> in the second parameter of <code class="highlighter-rouge">this.route()</code>. Because there is a <code class="highlighter-rouge">:</code> sign before the <code class="highlighter-rouge">library_id</code>, that part of the url will be copied as a variable, available as a param in our routes. For example, if the url is <code class="highlighter-rouge">http://example.com/libraries/1234/edit</code>, then <code class="highlighter-rouge">1234</code> will be passed as a param to the route so we can use it to fetch that specific model.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/router.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">config</span> <span class="nx">from</span> <span class="s1">'./config/environment'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">location</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">locationType</span>
<span class="p">});</span>

<span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'about'</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'invitations'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'contacts'</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'new'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'edit'</span><span class="p">,</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/:library_id/edit'</span> <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Router</span><span class="p">;</span>
</code></pre></div> <p>After inserting this extra line in our router, it’s time to create our <code class="highlighter-rouge">app/routes/libraries/edit.js</code>. You can use Ember CLI or you can create it manually. The code should look like the following. I’ll explain more below. (In this code, I use ES5 syntax, but later I will change it to ES6/ES2015. If you would like, you can use ES6/ES2015 right away.)</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/edit.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findRecord</span><span class="p">(</span><span class="s1">'library'</span><span class="p">,</span> <span class="nx">params</span><span class="p">.</span><span class="nx">library_id</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveLibrary</span><span class="p">(</span><span class="nx">newLibrary</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">newLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="nx">willTransition</span><span class="p">(</span><span class="nx">transition</span><span class="p">)</span> <span class="p">{</span>

      <span class="kd">let</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'model'</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'hasDirtyAttributes'</span><span class="p">))</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">confirmation</span> <span class="o">=</span> <span class="nx">confirm</span><span class="p">(</span><span class="s2">"Your changes haven't saved yet. Would you like to leave this form?"</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">confirmation</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">model</span><span class="p">.</span><span class="nx">rollbackAttributes</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">transition</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>A lot of things happening here.</p> <p>First of all, in the <code class="highlighter-rouge">model</code> function, we have a <code class="highlighter-rouge">params</code> parameter. <code class="highlighter-rouge">params</code> will contain that <code class="highlighter-rouge">id</code> from the url. We can access it with <code class="highlighter-rouge">params.library_id</code>. The <code class="highlighter-rouge">this.store.findRecord('library', params.library_id);</code> line downloads the single record from the server with the given <code class="highlighter-rouge">id</code>. The <code class="highlighter-rouge">id</code> comes from the url.</p> <p>We added two actions as well. The first will save the changes and then redirect the user to the main <code class="highlighter-rouge">libraries</code> page.</p> <p>The second event-action will be called when we are trying to leave the page, because we were redirected in the <code class="highlighter-rouge">saveLibrary</code> action or the user clicked on a link on the website. In the first case, the changes are already saved, but in the second case, the user may have modified something in the form but not saved it. This is known as “dirty checking”. We can read the <code class="highlighter-rouge">model</code> from the controller, and use Ember Model’s <code class="highlighter-rouge">hasDirtyAttributes</code> computed property to check whether something was changed in the model. If so, we popup an ugly confirmation window. If the user would like to leave the page, we just rollback the changes with <code class="highlighter-rouge">model.rollbackAttributes()</code>. If the user would like to stay on the page, we abort the transition with <code class="highlighter-rouge">transition.abort()</code>. You can see that we use the <code class="highlighter-rouge">transition</code> variable, which is initiated as a param in the <code class="highlighter-rouge">willTransition</code> function. Ember.js automatically provides this for us.</p> <p>Our template is still missing. Let’s use our <code class="highlighter-rouge">new.hbs</code> and duplicate the code in <code class="highlighter-rouge">edit.hbs</code>, with a few changes. We will fix this problem later with reusable “components”, because code duplication is not elegant.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h2&gt;</span>Edit Library<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-horizontal"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">name</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The name of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Address<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">address</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The address of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Phone<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">model</span><span class="p">.</span><span class="nv">phone</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The phone number of the Library"</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-offset-2 col-sm-10"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-default"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'saveLibrary'</span> <span class="nv">model</span><span class="k">}}</span><span class="nt">&gt;</span>Save changes<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>If you launch your app, it should work; you are able to edit the information from a library. You can see the “dirty checking” if you modify the data in the form, and then click on a link somewhere (e.x. a link on the menu) without saving the form data.</p> <h4 id="add-delete-action">Add delete action</h4> <p>The delete action is still missing. Let’s update <code class="highlighter-rouge">app/routes/libraries/index.js</code></p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/index.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'library'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">deleteLibrary</span><span class="p">(</span><span class="nx">library</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">confirmation</span> <span class="o">=</span> <span class="nx">confirm</span><span class="p">(</span><span class="s1">'Are you sure?'</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">confirmation</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">library</span><span class="p">.</span><span class="nx">destroyRecord</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">})</span>
</code></pre></div> <h3 id="homework-3">Homework</h3> <p>You can add delete buttons to the lists on your Admin pages, so you can delete invitations and contact messages. Another nice improvement would be to could clean up <code class="highlighter-rouge">app/controllers/index.js</code> and add a <code class="highlighter-rouge">createRecord</code> in the model method of <code class="highlighter-rouge">app/routes/index.js</code>. It would be similar to the <code class="highlighter-rouge">libraries/new.js</code> route.</p> <h2 id="lesson-5"><a name="lesson-5"></a>Lesson 5</h2> <h3 id="cleaning-up-our-templates-with-components">Cleaning up our templates with components</h3> <p>First of all, please read more about Components in the Ember.js Guide: <a href="http://guides.emberjs.com/v2.8.0/components/defining-a-component/">http://guides.emberjs.com/v2.8.0/components/defining-a-component/</a></p> <p>We can generate a component with <code class="highlighter-rouge">ember g component</code>. Let’s create two components. One for the library panel, and one for forms.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g component library-item
$ ember g component library-item-form
</code></pre></div> <p>Each command generates a javascript file and a handlebars file. The javascript part sits in the <code class="highlighter-rouge">app/components/</code> folder, the template in <code class="highlighter-rouge">app/templates/components/</code>.</p> <p>We can insert the following code into our <code class="highlighter-rouge">library-item</code> template.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/library-item.hbs --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel panel-default library-item"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"panel-title"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">item</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span><span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-body"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>Address: <span class="k">{{</span><span class="nv">item</span><span class="p">.</span><span class="nv">address</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;</span>Phone: <span class="k">{{</span><span class="nv">item</span><span class="p">.</span><span class="nv">phone</span><span class="k">}}</span><span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-footer text-right"</span><span class="nt">&gt;</span>
      <span class="k">{{</span><span class="nv">yield</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>You can see that this code is quite similar to what we have in <code class="highlighter-rouge">app/templates/libraries/index.hbs</code>, however instead of <code class="highlighter-rouge">model</code> we use <code class="highlighter-rouge">item</code>.</p> <p>The most important concept in terms of components is that they are totally independent from the context. They don’t know “other things”, other variables. They only know what they originally have and what’s passed inside with attributes.</p> <p>We have a <code class="highlighter-rouge"><span class="p">{</span><span class="err">{yield</span><span class="p">}</span><span class="err">}</span></code> which means that we can use this component as a block component. The code that this component wraps around will be injected inside the <code class="highlighter-rouge"><span class="p">{</span><span class="err">{yield</span><span class="p">}</span><span class="err">}</span></code>.</p> <p>For example:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="k">{{#</span><span class="nn">library-item</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span><span class="k">}}</span>
  Closed
<span class="k">{{/</span><span class="nn">library-item</span><span class="k">}}</span>
</code></pre></div> <p>In this case the <code class="highlighter-rouge">Closed</code> text will appear in the panel footer.</p> <p>Let’s add html to our <code class="highlighter-rouge">library-item-form</code> component as well.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/library-item-form.hbs --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-horizontal"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group has-feedback </span><span class="k">{{</span><span class="nv">if</span> <span class="nv">item</span><span class="p">.</span><span class="nv">isValid</span> <span class="s1">'has-success'</span><span class="k">}}</span><span class="s">"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Name*<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
          <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">item</span><span class="p">.</span><span class="nv">name</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The name of the Library"</span><span class="k">}}</span>
          <span class="k">{{#if</span> <span class="nv">item</span><span class="p">.</span><span class="nv">isValid</span><span class="k">}}</span><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-ok form-control-feedback"</span><span class="nt">&gt;&lt;/span&gt;</span><span class="k">{{/if}}</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Address<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
          <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">item</span><span class="p">.</span><span class="nv">address</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The address of the Library"</span><span class="k">}}</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"col-sm-2 control-label"</span><span class="nt">&gt;</span>Phone<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-10"</span><span class="nt">&gt;</span>
          <span class="k">{{</span><span class="nv">input</span> <span class="nv">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">value</span><span class="o">=</span><span class="nv">item</span><span class="p">.</span><span class="nv">phone</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">"The phone number of the Library"</span><span class="k">}}</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-offset-2 col-sm-10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-default"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'buttonClicked'</span> <span class="nv">item</span><span class="k">}}</span> <span class="na">disabled=</span><span class="k">{{</span><span class="nv">unless</span> <span class="nv">item</span><span class="p">.</span><span class="nv">isValid</span> <span class="kc">true</span><span class="k">}}</span><span class="err">&gt;</span><span class="k">{{</span><span class="nv">buttonLabel</span><span class="k">}}</span><span class="s">&lt;/button</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>This code is almost identical to the code we used multiple times in <code class="highlighter-rouge">libraries/new.hbs</code> and <code class="highlighter-rouge">libraries/edit.hbs</code>.</p> <p>A tiny improvement is to add a little validation to our <code class="highlighter-rouge">library</code> model. Please update <code class="highlighter-rouge">app/models/library.js</code> to include this basic validation, where we check that the <code class="highlighter-rouge">name</code> is not empty. (Don’t forget to import Ember on the top of the file.)</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/models/library.js</span>
<span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">'ember-data'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  
  <span class="na">name</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">address</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">phone</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div> <p>Time to clean up our templates using these new components.</p> <p>Using the <code class="highlighter-rouge">library-item</code> component in <code class="highlighter-rouge">app/templates/libraries/index.hbs</code> reduces the amount of code and makes our template cleaner.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h2&gt;</span>List<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">library</span><span class="err">|</span><span class="k">}}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
      <span class="k">{{#</span><span class="nn">library-item</span> <span class="nv">item</span><span class="o">=</span><span class="nv">library</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'libraries.edit'</span> <span class="nv">library</span><span class="p">.</span><span class="nv">id</span> <span class="nv">class</span><span class="o">=</span><span class="s1">'btn btn-success btn-xs'</span><span class="k">}}</span>Edit<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
        <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-danger btn-xs"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'deleteLibrary'</span> <span class="nv">library</span><span class="k">}}</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/button&gt;</span>
      <span class="k">{{/</span><span class="nn">library-item</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>We iterate through each <code class="highlighter-rouge">library</code> in our <code class="highlighter-rouge">model</code>, and then pass that <code class="highlighter-rouge">library</code> local variable as <code class="highlighter-rouge">item</code> to the <code class="highlighter-rouge">library-item</code> component. The name of the component’s variable is always on the left side of the assignment.</p> <p>Because this component is a block component, we can add some extra content to the library item footer. In this case, we add Edit and Delete buttons.</p> <p>If you check your app in a browser, the Libraries list page should look the same as before, however, the code is cleaner and we have a component that we can reuse elsewhere.</p> <p>Update our <code class="highlighter-rouge">app/templates/libraries/new.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/libraries/new.hbs --&gt;</span>
<span class="nt">&lt;h2&gt;</span>Add a new local Library<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6"</span><span class="nt">&gt;</span>
    <span class="k">{{</span><span class="nv">library-item-form</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span> <span class="nv">buttonLabel</span><span class="o">=</span><span class="s1">'Add to library list'</span> <span class="nv">action</span><span class="o">=</span><span class="s1">'saveLibrary'</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
    <span class="k">{{#</span><span class="nn">library-item</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span><span class="k">}}</span>
      <span class="nt">&lt;br/&gt;</span>
    <span class="k">{{/</span><span class="nn">library-item</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>Let’s update <code class="highlighter-rouge">app/templates/libraries/edit.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h2&gt;</span>Edit Library<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6"</span><span class="nt">&gt;</span>
    <span class="k">{{</span><span class="nv">library-item-form</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span> <span class="nv">buttonLabel</span><span class="o">=</span><span class="s1">'Save changes'</span> <span class="nv">action</span><span class="o">=</span><span class="s1">'saveLibrary'</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>
  
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
    <span class="k">{{#</span><span class="nn">library-item</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span><span class="k">}}</span>
      <span class="nt">&lt;br/&gt;</span>
    <span class="k">{{/</span><span class="nn">library-item</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>
  
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>Add the <code class="highlighter-rouge">buttonClicked</code> action to <code class="highlighter-rouge">library-item-form.js</code>.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Component</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">buttonLabel</span><span class="p">:</span> <span class="s1">'Save'</span><span class="p">,</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">buttonClicked</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">sendAction</span><span class="p">(</span><span class="s1">'action'</span><span class="p">,</span> <span class="nx">param</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <h3 id="merge--and--into--and-use--and-">Merge <code class="highlighter-rouge">edit.hbs</code> and <code class="highlighter-rouge">new.hbs</code> into <code class="highlighter-rouge">form.hbs</code> and use <code class="highlighter-rouge">renderTemplate()</code> and <code class="highlighter-rouge">setupController()</code></h3> <p><code class="highlighter-rouge">edit.hbs</code> and <code class="highlighter-rouge">new.hbs</code> are almost the same, so we can use the same template in both routes.</p> <p>Let’s create a <code class="highlighter-rouge">form.hbs</code> which will be our common template in Edit and in New page.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- /app/templates/libraries/form.hbs --&gt;</span>
<span class="nt">&lt;h2&gt;</span><span class="k">{{</span><span class="nv">title</span><span class="k">}}</span><span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6"</span><span class="nt">&gt;</span>
    <span class="k">{{</span><span class="nv">library-item-form</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span> <span class="nv">buttonLabel</span><span class="o">=</span><span class="nv">buttonLabel</span> <span class="nv">action</span><span class="o">=</span><span class="s1">'saveLibrary'</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>
  
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
    <span class="k">{{#</span><span class="nn">library-item</span> <span class="nv">item</span><span class="o">=</span><span class="nv">model</span><span class="k">}}</span>
      <span class="nt">&lt;br/&gt;</span>
    <span class="k">{{/</span><span class="nn">library-item</span><span class="k">}}</span>
  <span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>To use the common template above, we have to do two things. First, we have to set the <code class="highlighter-rouge">title</code> and <code class="highlighter-rouge">buttonLabel</code> params in our controllers. Second, we have to let Ember know not to look for the default template based on the current route (e.x. in the route <code class="highlighter-rouge">libraries/new</code>, by default Ember looks for the template located at <code class="highlighter-rouge">templates/libraries/new.hbs</code>). To set controller params in a Route, we can use the <code class="highlighter-rouge">setupController</code> hook. For setting a non-default template location, we can use the <code class="highlighter-rouge">renderTemplate</code> hook.</p> <p>With these two new hooks, our <code class="highlighter-rouge">app/routes/libraries/new.js</code> should look like this:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/new.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">model</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'library'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">setupController</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span>

    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'Create a new library'</span><span class="p">);</span>
    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'buttonLabel'</span><span class="p">,</span> <span class="s1">'Create'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">renderTemplate</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'libraries/form'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveLibrary</span><span class="p">(</span><span class="nx">newLibrary</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">newLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="nx">willTransition</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'model'</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'isNew'</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">destroyRecord</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>And our <code class="highlighter-rouge">edit.js</code></p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/libraries/edit.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findRecord</span><span class="p">(</span><span class="s1">'library'</span><span class="p">,</span> <span class="nx">params</span><span class="p">.</span><span class="nx">library_id</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">setupController</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span>

    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'Edit library'</span><span class="p">);</span>
    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'buttonLabel'</span><span class="p">,</span> <span class="s1">'Save changes'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">renderTemplate</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'libraries/form'</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">saveLibrary</span><span class="p">(</span><span class="nx">newLibrary</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">newLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">transitionTo</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="nx">willTransition</span><span class="p">(</span><span class="nx">transition</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'model'</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'hasDirtyAttributes'</span><span class="p">))</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">confirmation</span> <span class="o">=</span> <span class="nx">confirm</span><span class="p">(</span><span class="s2">"Your changes haven't saved yet. Would you like to leave this form?"</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">confirmation</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">model</span><span class="p">.</span><span class="nx">rollbackAttributes</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">transition</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>You can delete <code class="highlighter-rouge">edit.hbs</code> and <code class="highlighter-rouge">new.hbs</code> from the <code class="highlighter-rouge">app/templates/libraries/</code> folder. We don’t need them anymore.</p> <p>More information about <code class="highlighter-rouge">setupController</code>: <a href="http://emberjs.com/api/classes/Ember.Route.html#method_setupController">http://emberjs.com/api/classes/Ember.Route.html#method_setupController</a></p> <p>More information about <code class="highlighter-rouge">renderTemplate</code>: <a href="http://emberjs.com/api/classes/Ember.Route.html#method_renderTemplate">http://emberjs.com/api/classes/Ember.Route.html#method_renderTemplate</a></p> <h3 id="create-a-tiny-bootstrap--component-for-"><a name="nav-link-to"></a>Create a tiny bootstrap <code class="highlighter-rouge">nav-link-to</code> component for <code class="highlighter-rouge">&lt;li&gt;&lt;a&gt;&lt;/a&gt;&lt;/li&gt;</code></h3> <p>Time to clean up our navigation template. We’ll create a nice component that properly manages bootstrap <code class="highlighter-rouge">navbar</code> links.</p> <p>Open your terminal and generate a new component with Ember CLI.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g component nav-link-to
</code></pre></div> <p>Because we would like to just slightly modify the built-in <code class="highlighter-rouge">LinkComponent</code>, we should just <code class="highlighter-rouge">extend</code> that class. We can utilize the <code class="highlighter-rouge">tagName</code> property, which determines the main tag of a component.</p> <p>Update <code class="highlighter-rouge">app/components/nav-link-to.js</code>:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/components/nav-link-to.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">LinkComponent</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">tagName</span><span class="p">:</span> <span class="s1">'li'</span>
<span class="p">});</span>
</code></pre></div> <p>Note: don’t forget to change <code class="highlighter-rouge">Ember.Component.extend</code> to <code class="highlighter-rouge">Ember.LinkComponent.extend</code>.</p> <p>The corresponding <code class="highlighter-rouge">nav-link-to</code> template will be the following:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/nav-link-to.hbs --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">yield</span><span class="k">}}</span><span class="nt">&lt;/a&gt;</span>
</code></pre></div> <p>Now we are ready to use our component in our <code class="highlighter-rouge">navbar.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/navbar.hbs --&gt;</span>
<span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"navbar navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"navbar-header"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"navbar-toggle collapsed"</span> <span class="na">data-toggle=</span><span class="s">"collapse"</span> <span class="na">data-target=</span><span class="s">"#main-navbar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Toggle navigation<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;/button&gt;</span>
      <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"navbar-brand"</span><span class="k">}}</span>Library App<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"main-navbar"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'index'</span><span class="k">}}</span>Home<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'libraries'</span><span class="k">}}</span>Libraries<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'about'</span><span class="k">}}</span>About<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'contact'</span><span class="k">}}</span>Contact<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
      <span class="nt">&lt;/ul&gt;</span>

      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"dropdown"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"dropdown-toggle"</span> <span class="na">data-toggle=</span><span class="s">"dropdown"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-haspopup=</span><span class="s">"true"</span> <span class="na">aria-expanded=</span><span class="s">"false"</span><span class="nt">&gt;</span>
            Admin<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"caret"</span><span class="nt">&gt;&lt;/span&gt;</span>
          <span class="nt">&lt;/a&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"dropdown-menu"</span><span class="nt">&gt;</span>
            <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'admin.invitations'</span><span class="k">}}</span>Invitations<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
            <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'admin.contacts'</span><span class="k">}}</span>Contacts<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
          <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.navbar-collapse --&gt;</span>
  <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.container-fluid --&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</code></pre></div> <p><em>Sidenote</em>: If you have to solve this problem in a real application, I published an <a href="https://www.emberobserver.com/addons/ember-bootstrap-nav-link">Ember Addon</a>, which automatically adds this component to your project, it is more complex, please use that one. You can check the source code on <a href="https://github.com/zoltan-nz/ember-bootstrap-nav-link">Ember Bootstrap Nav Link</a> repository.</p> <h2 id="lesson-6"><a name="lesson-6"></a>Lesson 6</h2> <p>In this lesson, we’ll add the models <code class="highlighter-rouge">book</code> and <code class="highlighter-rouge">author</code>, and set up relations between models. We’ll also create a new page where we can generate dummy data with an external javascript library to fill up our database automatically.</p> <h3 id="creating-some-new-models-and-setting-up-relations">Creating some new models and setting up relations</h3> <p>In our simple World, we have Libraries, and we have Authors (who can have a few Books). A Book can only be in one Library, and each Book has only one Author.</p> <p>To generate the new models, we’ll use Ember CLI.</p> <p>Run the following in your terminal.</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember g model book title:string releaseYear:date library:belongsTo author:belongsTo
<span class="gp">$ </span>ember g model author name:string books:hasMany
</code></pre></div> <p>Now add a <code class="highlighter-rouge">hasMany</code> relation to the <code class="highlighter-rouge">library</code> model manually.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/models/library.js</span>
<span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">'ember-data'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">name</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">address</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">phone</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>

  <span class="na">books</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="s1">'book'</span><span class="p">),</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="s1">'name'</span><span class="p">),</span>
<span class="p">});</span>
</code></pre></div> <h3 id="create-a-new-admin-page-seeder-and-retrieve-multiple-models-in-the-same-route">Create a new Admin page ‘Seeder’ and retrieve multiple models in the same route.</h3> <p>Create a new page using Ember CLI in your terminal:</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember g route admin/seeder
</code></pre></div> <p>Check <code class="highlighter-rouge">router.js</code>. A new route should be there which points to <code class="highlighter-rouge">seeder</code>.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/router.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">config</span> <span class="nx">from</span> <span class="s1">'./config/environment'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">location</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">locationType</span>
<span class="p">});</span>

<span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'about'</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'invitations'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'contacts'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'seeder'</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'new'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">'edit'</span><span class="p">,</span> <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'/:library_id/edit'</span> <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Router</span><span class="p">;</span>
</code></pre></div> <p>Extend your <code class="highlighter-rouge">navbar.hbs</code> with the new page.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/navbar.hbs --&gt;</span>
<span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"navbar navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"navbar-header"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"navbar-toggle collapsed"</span> <span class="na">data-toggle=</span><span class="s">"collapse"</span> <span class="na">data-target=</span><span class="s">"#main-navbar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Toggle navigation<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon-bar"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;/button&gt;</span>
      <span class="k">{{#</span><span class="nn">link-to</span> <span class="s1">'index'</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"navbar-brand"</span><span class="k">}}</span>Library App<span class="k">{{/</span><span class="nn">link-to</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"collapse navbar-collapse"</span> <span class="na">id=</span><span class="s">"main-navbar"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav"</span><span class="nt">&gt;</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'index'</span><span class="k">}}</span>Home<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'libraries'</span><span class="k">}}</span>Libraries<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'about'</span><span class="k">}}</span>About<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
        <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'contact'</span><span class="k">}}</span>Contact<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
      <span class="nt">&lt;/ul&gt;</span>

      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"dropdown"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"dropdown-toggle"</span> <span class="na">data-toggle=</span><span class="s">"dropdown"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-haspopup=</span><span class="s">"true"</span> <span class="na">aria-expanded=</span><span class="s">"false"</span><span class="nt">&gt;</span>
            Admin<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"caret"</span><span class="nt">&gt;&lt;/span&gt;</span>
          <span class="nt">&lt;/a&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"dropdown-menu"</span><span class="nt">&gt;</span>
            <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'admin.invitations'</span><span class="k">}}</span>Invitations<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
            <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'admin.contacts'</span><span class="k">}}</span>Contacts<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
            <span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'admin.seeder'</span><span class="k">}}</span>Seeder<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
          <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.navbar-collapse --&gt;</span>
  <span class="nt">&lt;/div&gt;</span><span class="c">&lt;!-- /.container-fluid --&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</code></pre></div> <h4 id="using--to-retrieve-multiple-models-in-the-same-route">Using <code class="highlighter-rouge">Ember.RSVP.hash()</code> to retrieve multiple models in the same route</h4> <p>For downloading multiple models in the same route we have to use the <code class="highlighter-rouge">Ember.RSVP.hash()</code> function in the <code class="highlighter-rouge">model</code> hook.</p> <p><code class="highlighter-rouge">RSVP.hash</code> wraps multiple promises and returns a nicely structured hashed object. More information: <a href="http://emberjs.com/api/classes/RSVP.html#method_hash">http://emberjs.com/api/classes/RSVP.html#method_hash</a></p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/admin/seeder.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">RSVP</span><span class="p">.</span><span class="nx">hash</span><span class="p">({</span>
      <span class="na">libraries</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'library'</span><span class="p">),</span>
      <span class="na">books</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'book'</span><span class="p">),</span>
      <span class="na">authors</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'author'</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">},</span>

  <span class="nx">setupController</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">libraries</span><span class="p">);</span>
    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'books'</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">books</span><span class="p">);</span>
    <span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'authors'</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">authors</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>RSVP tries to download all three requested models, and only returns with a fulfilled state if all are retrieved successfully.</p> <p>In the <code class="highlighter-rouge">setupController</code> hook, we split up the models into their own controller property. Actually, you can skip this step. If you skip, you have to use <code class="highlighter-rouge">model.libraries</code>, <code class="highlighter-rouge">model.books</code> properties in your controller and in your template. Other option, if you have a controller, you can make an alias there, so other developers can immediately see where those property data come from with checking the Controller file only. (You can see the alternative “alias version” on my github repo.)</p> <h3 id="short-summary-of-route-hooks">Short summary of route hooks</h3> <p>You’ve already used a couple of hooks in routes, like <code class="highlighter-rouge">model</code> and <code class="highlighter-rouge">setupController</code>. Route hooks are called in specific sequence.</p> <p>You can use the following snippet to experiment with them in one of your routes.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">beforeModel</span><span class="p">(</span><span class="nx">transition</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">model</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">transition</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">afterModel</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">transition</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">activate</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">setupController</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">renderTemplate</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">debugger</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>If you visit the route where you inserted the code above and open your web browser’s inspector, the code will stop for debugging in each hook and you can see the order of the hooks. Here’s a list of the hooks in the order they’re called, and more information about each:</p> <ol> <li><code class="highlighter-rouge">init()</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_init">http://emberjs.com/api/classes/Ember.Route.html#method_init</a></li> <li><code class="highlighter-rouge">beforeModel(transition)</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_beforeModel">http://emberjs.com/api/classes/Ember.Route.html#method_beforeModel</a></li> <li><code class="highlighter-rouge">model(params, transition)</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_model">http://emberjs.com/api/classes/Ember.Route.html#method_model</a></li> <li><code class="highlighter-rouge">afterModel(model, transition)</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_afterModel">http://emberjs.com/api/classes/Ember.Route.html#method_afterModel</a></li> <li><code class="highlighter-rouge">activate()</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_activate">http://emberjs.com/api/classes/Ember.Route.html#method_activate</a></li> <li><code class="highlighter-rouge">setupController(controller, model)</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_setupController">http://emberjs.com/api/classes/Ember.Route.html#method_setupController</a></li> <li><code class="highlighter-rouge">renderTemplate(controller, model)</code> <a href="http://emberjs.com/api/classes/Ember.Route.html#method_renderTemplate">http://emberjs.com/api/classes/Ember.Route.html#method_renderTemplate</a></li> </ol> <h3 id="create-a-number-box-component-to-use-on-the-adminseeder-page-to-display-how-much-data-we-have-in-our-database">Create a “number box” component to use on the admin/seeder page to display how much data we have in our database</h3> <p>We’ll make a <code class="highlighter-rouge">number-box</code> component to visualize numbers on our page. Let’s create our fancy component.</p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember g component number-box
</code></pre></div> <p>Setup <code class="highlighter-rouge">css</code> class names in the component controller.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/components/number-box.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Component</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">classNames</span><span class="p">:</span> <span class="p">[</span><span class="s1">'panel'</span><span class="p">,</span> <span class="s1">'panel-warning'</span><span class="p">]</span>

<span class="p">});</span>
</code></pre></div> <p>And a little html in our component template:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/number-box.hbs --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"text-center"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">title</span><span class="k">}}</span><span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"text-center"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">if</span> <span class="nv">number</span> <span class="nv">number</span> <span class="s1">'...'</span><span class="k">}}</span><span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>As you can see, we can pass our component two attributes: <code class="highlighter-rouge">title</code> and <code class="highlighter-rouge">number</code>. If we are passed a value for <code class="highlighter-rouge">number</code>, we show that number, otherwise we show three dots.</p> <p>Our component template is ready. We can use it in <code class="highlighter-rouge">app/templates/admin/seeder.hbs</code>.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/admin/seeder.hbs --&gt;</span>
<span class="nt">&lt;h1&gt;</span>Seeder, our Data Center<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Libraries"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">libraries</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Authors"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">authors</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Books"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">books</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>If you open your browser now, you will see three boxes with numbers or three dots. Remember, we set up the <code class="highlighter-rouge">libraries</code>, <code class="highlighter-rouge">authors</code>, and <code class="highlighter-rouge">books</code> properties in our <code class="highlighter-rouge">setupController</code> hook. If our <code class="highlighter-rouge">model</code> hook downloaded our data from the server, those variables will not be empty. The <code class="highlighter-rouge">.length</code> method will return the size of that array. (As I mentioned above, you can skip remapping in <code class="highlighter-rouge">setupController</code> hook, in this case, you should use <code class="highlighter-rouge">model.libraries.length</code>, <code class="highlighter-rouge">model.authors.length</code>, etc. or as a third option you can add aliases in the controller.)</p> <h3 id="building-forms-to-generate-dummy-data">Building forms to generate dummy data</h3> <p>We have to generate two other components that we’re gonna use for the seeder page. Actually we’ll only use one component in the <code class="highlighter-rouge">admin/seeder.hbs</code> template, but inside that component we will use another component. This part is a little bit advanced; I don’t have a detailed explanation here, but you can copy paste the code and try out. I suggest playing around with the code to try to understand it, as well as checking out how it works in the <a href="https://library-app.firebaseapp.com/admin/seeder">demo</a>. However, don’t forget, if you have any question, don’t hesitate to ping me on Slack, on Twitter or in the comment section below.</p> <p>Run these Ember CLI commands in your terminal.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g component seeder-block
$ ember g component fader-label
</code></pre></div> <p>Insert the following codes in your component javascript files and templates.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/components/seeder-block.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">MAX_VALUE</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Component</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">counter</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>

  <span class="na">isCounterValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">lte</span><span class="p">(</span><span class="s1">'counter'</span><span class="p">,</span> <span class="nx">MAX_VALUE</span><span class="p">),</span>
  <span class="na">placeholder</span><span class="p">:</span> <span class="err">`</span><span class="nx">Max</span> <span class="nx">$</span><span class="p">{</span><span class="nx">MAX_VALUE</span><span class="p">}</span><span class="err">`</span><span class="p">,</span>
  
  <span class="na">createReady</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">deleteReady</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">generateAction</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'isCounterValid'</span><span class="p">))</span> <span class="p">{</span>

        <span class="c1">// Action up to Seeder Controller with the requested amount</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">sendAction</span><span class="p">(</span><span class="s1">'generateAction'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'counter'</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">deleteAction</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">sendAction</span><span class="p">(</span><span class="s1">'deleteAction'</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>
<span class="p">});</span>

</code></pre></div> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/seeder-block.hbs --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"well well-sm extra-padding-bottom"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;h3&gt;</span><span class="k">{{</span><span class="nv">sectionTitle</span><span class="k">}}</span><span class="nt">&lt;/h3&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-inline"</span><span class="nt">&gt;</span>
  
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group has-feedback </span><span class="k">{{</span><span class="nv">unless</span> <span class="nv">isCounterValid</span> <span class="s1">'has-error'</span><span class="k">}}</span><span class="s">"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"control-label"</span><span class="nt">&gt;</span>Number of new records:<span class="nt">&lt;/label&gt;</span>
      <span class="k">{{</span><span class="nv">input</span> <span class="nv">value</span><span class="o">=</span><span class="nv">counter</span> <span class="nv">class</span><span class="o">=</span><span class="s1">'form-control'</span> <span class="nv">placeholder</span><span class="o">=</span><span class="nv">placeholder</span><span class="k">}}</span>
    <span class="nt">&lt;/div&gt;</span>
    
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-primary"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'generateAction'</span><span class="k">}}</span> <span class="na">disabled=</span><span class="k">{{</span><span class="nv">if</span> <span class="nv">isCounterValid</span> <span class="kc">false</span> <span class="kc">true</span><span class="k">}}</span><span class="err">&gt;</span><span class="s">Generate</span> <span class="k">{{</span><span class="nv">sectionTitle</span><span class="k">}}</span><span class="err">&lt;/</span><span class="na">button</span><span class="nt">&gt;</span>
    <span class="k">{{#</span><span class="nn">fader-label</span> <span class="nv">isShowing</span><span class="o">=</span><span class="nv">createReady</span><span class="k">}}</span>Created!<span class="k">{{/</span><span class="nn">fader-label</span><span class="k">}}</span>
    
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-danger"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'deleteAction'</span><span class="k">}}</span><span class="nt">&gt;</span>Delete All <span class="k">{{</span><span class="nv">sectionTitle</span><span class="k">}}</span><span class="nt">&lt;/button&gt;</span>
    <span class="k">{{#</span><span class="nn">fader-label</span> <span class="nv">isShowing</span><span class="o">=</span><span class="nv">deleteReady</span><span class="k">}}</span>Deleted!<span class="k">{{/</span><span class="nn">fader-label</span><span class="k">}}</span>
  
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/components/fader-label.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Component</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">tagName</span><span class="p">:</span> <span class="s1">'span'</span><span class="p">,</span>

  <span class="na">classNames</span><span class="p">:</span> <span class="p">[</span><span class="s1">'label label-success label-fade'</span><span class="p">],</span>
  <span class="na">classNameBindings</span><span class="p">:</span> <span class="p">[</span><span class="s1">'isShowing:label-show'</span><span class="p">],</span>

  <span class="na">isShowing</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>

  <span class="na">isShowingChanged</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">observer</span><span class="p">(</span><span class="s1">'isShowing'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Ember</span><span class="p">.</span><span class="nx">run</span><span class="p">.</span><span class="nx">later</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'isShowing'</span><span class="p">,</span> <span class="kc">false</span><span class="p">),</span> <span class="mi">3000</span><span class="p">);</span>
  <span class="p">})</span>
<span class="p">});</span>

</code></pre></div> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/components/fader-label.hbs --&gt;</span>
<span class="k">{{</span><span class="nv">yield</span><span class="k">}}</span>
</code></pre></div> <p>We need also a little <code class="highlighter-rouge">scss</code> snippet.</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/styles/app.scss
</span><span class="k">@import</span> <span class="s1">'bootstrap'</span><span class="p">;</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">padding-top</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">html</span> <span class="p">{</span>
  <span class="nl">overflow-y</span><span class="p">:</span> <span class="nb">scroll</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.library-item</span> <span class="p">{</span>
  <span class="nl">min-height</span><span class="p">:</span> <span class="m">150px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.label-fade</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="k">@include</span> <span class="nd">transition</span><span class="p">(</span><span class="n">all</span> <span class="m">0</span><span class="mi">.5s</span><span class="p">);</span>
  <span class="k">&amp;</span><span class="nc">.label-show</span> <span class="p">{</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
  
<span class="nc">.extra-padding-bottom</span> <span class="p">{</span>
  <span class="nl">padding-bottom</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div> <p>We have our components, let’s insert them in <code class="highlighter-rouge">seeder.hbs</code></p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/admin/seeder.hbs --&gt;</span>
<span class="nt">&lt;h1&gt;</span>Seeder, our Data Center<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Libraries"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">libraries</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Authors"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">authors</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">number-box</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"Books"</span> <span class="nv">number</span><span class="o">=</span><span class="nv">books</span><span class="p">.</span><span class="nv">length</span><span class="k">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="k">{{</span><span class="nv">seeder-block</span>
    <span class="nv">sectionTitle</span><span class="o">=</span><span class="s1">'Libraries'</span>
    <span class="nv">generateAction</span><span class="o">=</span><span class="s1">'generateLibraries'</span>
    <span class="nv">deleteAction</span><span class="o">=</span><span class="s1">'deleteLibraries'</span>
    <span class="nv">createReady</span><span class="o">=</span><span class="nv">libDone</span>
    <span class="nv">deleteReady</span><span class="o">=</span><span class="nv">libDelDone</span><span class="k">}}</span>

<span class="k">{{</span><span class="nv">seeder-block</span>
    <span class="nv">sectionTitle</span><span class="o">=</span><span class="s1">'Authors with Books'</span>
    <span class="nv">generateAction</span><span class="o">=</span><span class="s1">'generateBooksAndAuthors'</span>
    <span class="nv">deleteAction</span><span class="o">=</span><span class="s1">'deleteBooksAndAuthors'</span>
    <span class="nv">createReady</span><span class="o">=</span><span class="nv">authDone</span>
    <span class="nv">deleteReady</span><span class="o">=</span><span class="nv">authDelDone</span><span class="k">}}</span>
</code></pre></div> <h3 id="install--for-dummy-data">Install <code class="highlighter-rouge">faker.js</code> for dummy data</h3> <p>To generate dummy data we have to install <code class="highlighter-rouge">faker.js</code>. <a href="https://github.com/johnotander/ember-faker">https://github.com/johnotander/ember-faker</a></p> <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ember install ember-faker
</code></pre></div> <p>We import <code class="highlighter-rouge">faker</code> in our models, where we extend each of our models with a <code class="highlighter-rouge">randomize()</code> function for generating dummy data.</p> <p>Update your models with the followings.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/models/library.js</span>
<span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">'ember-data'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Faker</span> <span class="nx">from</span> <span class="s1">'faker'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">name</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">address</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">phone</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>

  <span class="na">books</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="s1">'book'</span><span class="p">,</span> <span class="p">{</span><span class="na">inverse</span><span class="p">:</span> <span class="s1">'library'</span><span class="p">,</span> <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">}),</span>

  <span class="na">isValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="s1">'name'</span><span class="p">),</span>

  <span class="nx">randomize</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="nx">Faker</span><span class="p">.</span><span class="nx">company</span><span class="p">.</span><span class="nx">companyName</span><span class="p">()</span> <span class="o">+</span> <span class="s1">' Library'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'address'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fullAddress</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'phone'</span><span class="p">,</span> <span class="nx">Faker</span><span class="p">.</span><span class="nx">phone</span><span class="p">.</span><span class="nx">phoneNumber</span><span class="p">());</span>

    <span class="c1">// If you would like to use in chain.</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">_fullAddress</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">Faker</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">streetAddress</span><span class="p">()},</span> <span class="nx">$</span><span class="p">{</span><span class="nx">Faker</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span><span class="p">()}</span><span class="err">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>

</code></pre></div> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/models/book.js</span>
<span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">'ember-data'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Faker</span> <span class="nx">from</span> <span class="s1">'faker'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">title</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">releaseYear</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'date'</span><span class="p">),</span>

  <span class="na">author</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="s1">'author'</span><span class="p">,</span> <span class="p">{</span><span class="na">inverse</span><span class="p">:</span> <span class="s1">'books'</span><span class="p">,</span> <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">}),</span>
  <span class="na">library</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="s1">'library'</span><span class="p">,</span> <span class="p">{</span><span class="na">inverse</span><span class="p">:</span> <span class="s1">'books'</span><span class="p">,</span> <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">}),</span>

  <span class="nx">randomize</span><span class="p">(</span><span class="nx">author</span><span class="p">,</span> <span class="nx">library</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_bookTitle</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'author'</span><span class="p">,</span> <span class="nx">author</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'releaseYear'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_randomYear</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'library'</span><span class="p">,</span> <span class="nx">library</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">_bookTitle</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">Faker</span><span class="p">.</span><span class="nx">commerce</span><span class="p">.</span><span class="nx">productName</span><span class="p">()}</span> <span class="nx">Cookbook</span><span class="err">`</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">_randomYear</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getRandomArbitrary</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">2015</span><span class="p">).</span><span class="nx">toPrecision</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
  <span class="p">},</span>

  <span class="nx">_getRandomArbitrary</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">min</span><span class="p">)</span> <span class="o">+</span> <span class="nx">min</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>

</code></pre></div> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/models/author.js</span>
<span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">'ember-data'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Faker</span> <span class="nx">from</span> <span class="s1">'faker'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="na">name</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'string'</span><span class="p">),</span>
  <span class="na">books</span><span class="p">:</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="s1">'book'</span><span class="p">,</span> <span class="p">{</span><span class="na">inverse</span><span class="p">:</span> <span class="s1">'author'</span><span class="p">,</span> <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">}),</span>

  <span class="na">isNotValid</span><span class="p">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="s1">'name'</span><span class="p">),</span>

  <span class="nx">randomize</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="nx">Faker</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">findName</span><span class="p">());</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>We will implement our actions in our controller.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/admin/seeder.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Faker</span> <span class="nx">from</span> <span class="s1">'faker'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="c1">// If you haven't mapped these properties in Route in setupController hook, you can alias them here, for example:</span>
  <span class="c1">// libraries: Ember.computed.alias('model.libraries')</span>
  <span class="na">libraries</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">books</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">authors</span><span class="p">:</span> <span class="p">[],</span>

  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>

    <span class="nx">generateLibraries</span><span class="p">(</span><span class="nx">volume</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">volume</span><span class="p">);</span>

      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">counter</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">isTheLast</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">counter</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_saveRandomLibrary</span><span class="p">(</span><span class="nx">isTheLast</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">deleteLibraries</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_destroyAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">));</span>

      <span class="c1">// Data down via seeder-block to fader-label that we ready to show the label</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'libDelDone'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">generateBooksAndAuthors</span><span class="p">(</span><span class="nx">volume</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">volume</span><span class="p">);</span>

      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">counter</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">isTheLast</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">counter</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">newAuthor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_saveRandomAuthor</span><span class="p">(</span><span class="nx">isTheLast</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_generateSomeBooks</span><span class="p">(</span><span class="nx">newAuthor</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">deleteBooksAndAuthors</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_destroyAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'books'</span><span class="p">));</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_destroyAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'authors'</span><span class="p">));</span>

      <span class="c1">// Data down via seeder-block to fader-label that we ready to show the label</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'authDelDone'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="c1">// Private methods</span>

  <span class="nx">_saveRandomLibrary</span><span class="p">(</span><span class="nx">isLast</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">randomLibrary</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'library'</span><span class="p">).</span><span class="nx">randomize</span><span class="p">();</span>

    <span class="nx">randomLibrary</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isLast</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Data down via seeder-block to fader-label that we ready to show the label</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'libDone'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="nx">_saveRandomAuthor</span><span class="p">(</span><span class="nx">isLast</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">newAuthor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'author'</span><span class="p">).</span><span class="nx">randomize</span><span class="p">();</span>
    <span class="nx">newAuthor</span><span class="p">.</span><span class="nx">save</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isLast</span><span class="p">)</span> <span class="p">{</span>

          <span class="c1">// Data down via seeder-block to fader-label that we ready to show the label</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'authDone'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="nx">newAuthor</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">_generateSomeBooks</span><span class="p">(</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">bookCounter</span> <span class="o">=</span> <span class="nx">Faker</span><span class="p">.</span><span class="nx">random</span><span class="p">.</span><span class="nx">number</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bookCounter</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">library</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selectRandomLibrary</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">createRecord</span><span class="p">(</span><span class="s1">'book'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">randomize</span><span class="p">(</span><span class="nx">author</span><span class="p">,</span> <span class="nx">library</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">save</span><span class="p">();</span>
      <span class="nx">author</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
      <span class="nx">library</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">_selectRandomLibrary</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">libraries</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'libraries'</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">librariesCounter</span> <span class="o">=</span> <span class="nx">libraries</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'length'</span><span class="p">);</span>

    <span class="c1">// Create a new array from ids</span>
    <span class="kr">const</span> <span class="nx">libraryIds</span> <span class="o">=</span> <span class="nx">libraries</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">lib</span> <span class="o">=&gt;</span> <span class="nx">lib</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'id'</span><span class="p">));</span>

    <span class="c1">// Randomly pick one id from the libraryIds array and return the library</span>
    <span class="kr">const</span> <span class="nx">randomNumber</span> <span class="o">=</span> <span class="nx">Faker</span><span class="p">.</span><span class="nx">random</span><span class="p">.</span><span class="nx">number</span><span class="p">(</span><span class="nx">librariesCounter</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">randomLibrary</span> <span class="o">=</span> <span class="nx">libraries</span><span class="p">.</span><span class="nx">findBy</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="nx">libraryIds</span><span class="p">[</span><span class="nx">randomNumber</span><span class="p">]);</span>

    <span class="k">return</span> <span class="nx">randomLibrary</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">_destroyAll</span><span class="p">(</span><span class="nx">records</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">records</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span>
      <span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">destroyRecord</span><span class="p">()</span>
    <span class="p">);</span>
  <span class="p">}</span>

<span class="p">});</span>
</code></pre></div> <h2 id="lesson-7"><a name="lesson-7"></a>Lesson 7</h2> <p>(work in progress)</p> <h3 id="crud-interface-for-authors-and-books-managing-model-relationship">CRUD interface for Authors and Books, managing model relationship</h3> <p>We are going to create two new pages: Authors and Books, where we list our data and manage them. We implement create, edit and delete functionality, search and pagination also. You can learn here, how could you manage relations between models. (Still work in progress, listing and editing author’s data is implemented so far.)</p> <p>Let’s create our two new pages.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ ember g route authors
$ ember g route books
</code></pre></div> <p>These will add two new lines to our <code class="highlighter-rouge">router.js</code>.</p> <div class="highlighter-rouge"><pre class="highlight"><code>this.route('authors');
this.route('books');
</code></pre></div> <p>We have two new template files also: <code class="highlighter-rouge">authors.hbs</code> and <code class="highlighter-rouge">books.hbs</code></p> <p>You can find two new files in <code class="highlighter-rouge">app/routes</code> folder: <code class="highlighter-rouge">authors.js</code> and <code class="highlighter-rouge">books.js</code></p> <p>Let’s extend our navigation bar. Just add the following two lines to your <code class="highlighter-rouge">navbar.hbs</code>. I just inserted next to the <code class="highlighter-rouge">Libraries</code> menu point. (You can move the <code class="highlighter-rouge">About</code> and <code class="highlighter-rouge">Contact</code> menu point next to the <code class="highlighter-rouge">Admin</code> also.)</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'authors'</span><span class="k">}}</span>Authors<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
<span class="k">{{#</span><span class="nn">nav-link-to</span> <span class="s1">'books'</span><span class="k">}}</span>Books<span class="k">{{/</span><span class="nn">nav-link-to</span><span class="k">}}</span>
</code></pre></div> <p>We are going to focus here on Authors page, we build it up together, after as a practice you can build up the Books section yourself. ;)</p> <h4 id="check-the--model">Check the <code class="highlighter-rouge">Author</code> model</h4> <p>First, check <code class="highlighter-rouge">app/models/author.js</code> file. If you’ve followed the Lesson 6 and added <code class="highlighter-rouge">Faker</code>, maybe you have some extra lines in your model, like <code class="highlighter-rouge">randomize()</code> method, however for us the most important is the Author model fields:</p> <p><code class="highlighter-rouge">js name: DS.attr('string'), books: DS.hasMany('book', {inverse: 'author'}), </code></p> <p>So we have a <code class="highlighter-rouge">name</code> field and a <code class="highlighter-rouge">books</code> field, which is related to the <code class="highlighter-rouge">Book</code> model. The <code class="highlighter-rouge">inverse</code> property is not really necessary, because we follow strictly the conventions, but I just leave there, so you can learn more about it in the official guide: <a href="https://guides.emberjs.com/v2.8.0/models/relationships/#toc_explicit-inverses">https://guides.emberjs.com/v2.8.0/models/relationships/#toc_explicit-inverses</a></p> <h4 id="download-data-from-the-server">Download data from the server</h4> <p>We would like to list all authors, when the user visits Authors page, we have to download the data from the server. Let’s implement the <code class="highlighter-rouge">model()</code> hook in Authors’ route handler.</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/authors.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'author'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>Now we can update the <code class="highlighter-rouge">authors</code> template file to list all data.</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code> <span class="c">&lt;!-- app/templates/authors.hbs --&gt;</span>
 <span class="nt">&lt;h1&gt;</span>Authors<span class="nt">&lt;/h1&gt;</span>

 <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-bordered table-striped"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;thead&gt;</span>
     <span class="nt">&lt;tr&gt;</span>
       <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
       <span class="nt">&lt;th&gt;</span>Books<span class="nt">&lt;/th&gt;</span>
     <span class="nt">&lt;/tr&gt;</span>
   <span class="nt">&lt;/thead&gt;</span>
   <span class="nt">&lt;tbody&gt;</span>
     <span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">author</span><span class="err">|</span><span class="k">}}</span>
       <span class="nt">&lt;tr&gt;</span>
         <span class="nt">&lt;td&gt;</span><span class="k">{{</span><span class="nv">author</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span><span class="nt">&lt;/td&gt;</span>
         <span class="nt">&lt;td&gt;</span>
           <span class="nt">&lt;ul&gt;</span>
             <span class="k">{{#</span><span class="nn">each</span> <span class="nv">author</span><span class="p">.</span><span class="nv">books</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">book</span><span class="err">|</span><span class="k">}}</span>
               <span class="nt">&lt;li&gt;</span><span class="k">{{</span><span class="nv">book</span><span class="p">.</span><span class="nv">title</span><span class="k">}}</span><span class="nt">&lt;/li&gt;</span>
             <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
           <span class="nt">&lt;/ul&gt;</span>
         <span class="nt">&lt;/td&gt;</span>
       <span class="nt">&lt;/tr&gt;</span>
     <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
   <span class="nt">&lt;/tbody&gt;</span>
 <span class="nt">&lt;/table&gt;</span>
</code></pre></div> <p>It’s a simple striped table with two columns. Because <code class="highlighter-rouge">model</code> array contains all the record about authors (we returned those in <code class="highlighter-rouge">model()</code> hook in the route handler and Ember automatically passes forward those records to controller and add to <code class="highlighter-rouge">model</code> property), so we can list them with an <code class="highlighter-rouge">each</code> block. Showing the <code class="highlighter-rouge">author.name</code> is simple.</p> <p>The interesting part is using the <code class="highlighter-rouge">author.books</code>. Ember Data asynchronously downloads the related model if we use that information. We previously setup in our <code class="highlighter-rouge">model/author.js</code> file, that <code class="highlighter-rouge">books</code> field connect to <code class="highlighter-rouge">Book</code> model with a <code class="highlighter-rouge">hasMany</code> relationship. Ember Data fills that field with an array of records. We can use an <code class="highlighter-rouge">each</code> block to iterate them and list in our table. Check out in your app. (If you use <code class="highlighter-rouge">Faker</code> for generating book titles, you will see a few funny data there. :) )</p> <h4 id="click-on-a-name-to-edit-authors-name">Click on a name to edit Author’s name</h4> <p>Let’s improve further our template. At this stage we will add functionality to the main <code class="highlighter-rouge">authors.hbs</code> template, however when you feel that a template is getting too big, you can clean it up extracting functionality to components. We can do it later.</p> <p>It would be cool if we would be able to edit an author’s name with clicking on it. It means, that an <code class="highlighter-rouge">author</code> would have two states: it is in editing mode and it is not. We can store this state in the model itself. It doesn’t have to be a “database” field, it is just a state in the memory. Let’s call it <code class="highlighter-rouge">isEditing</code>. In our <code class="highlighter-rouge">each</code> loop we can check <code class="highlighter-rouge">author.isEditing</code> true or false. When it is <code class="highlighter-rouge">true</code> we can show a form, else only the name.</p> <p>When we show only the name, we wrap it in a simple <code class="highlighter-rouge">&lt;span&gt;</code> with an <code class="highlighter-rouge">action</code> which manages the click event. We implement the <code class="highlighter-rouge">editAuthor</code> action in our route handler.</p> <p>When we edit the name, we have to manage <code class="highlighter-rouge">saveAuthor</code> action and <code class="highlighter-rouge">cancelAuthorEdit</code>. Additionally submit should be disabled if the new data is not valid.</p> <p>Update your <code class="highlighter-rouge">authors.hbs</code> template:</p> <div class="language-hbs highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- app/templates/authors.hbs --&gt;</span>
<span class="nt">&lt;h1&gt;</span>Authors<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-bordered table-striped"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;th&gt;</span>
      Name
      <span class="nt">&lt;br&gt;&lt;small</span> <span class="na">class=</span><span class="s">"small not-bold"</span><span class="nt">&gt;</span>(Click on name for editing)<span class="nt">&lt;/small&gt;</span>
    <span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"vtop"</span><span class="nt">&gt;</span>Books<span class="nt">&lt;/th&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
  <span class="k">{{#</span><span class="nn">each</span> <span class="nv">model</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">author</span><span class="err">|</span><span class="k">}}</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>
        <span class="k">{{#if</span> <span class="nv">author</span><span class="p">.</span><span class="nv">isEditing</span><span class="k">}}</span>
          <span class="nt">&lt;form</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'saveAuthor'</span> <span class="nv">author</span> <span class="nv">on</span><span class="o">=</span><span class="s1">'submit'</span><span class="k">}}</span> <span class="na">class=</span><span class="s">"form-inline"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"input-group"</span><span class="nt">&gt;</span>
              <span class="k">{{</span><span class="nv">input</span> <span class="nv">value</span><span class="o">=</span><span class="nv">author</span><span class="p">.</span><span class="nv">name</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control"</span><span class="k">}}</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"input-group-btn"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-success"</span> <span class="na">disabled=</span><span class="k">{{</span><span class="nv">author</span><span class="p">.</span><span class="nv">isNotValid</span><span class="k">}}</span><span class="err">&gt;</span><span class="s">Save&lt;/button</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-danger"</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'cancelAuthorEdit'</span> <span class="nv">author</span><span class="k">}}</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/button&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/form&gt;</span>
        <span class="k">{{else}}</span>
          <span class="nt">&lt;span</span> <span class="k">{{</span><span class="nv">action</span> <span class="s1">'editAuthor'</span> <span class="nv">author</span><span class="k">}}</span><span class="nt">&gt;</span><span class="k">{{</span><span class="nv">author</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span><span class="nt">&lt;/span&gt;</span>
        <span class="k">{{/if}}</span>
      <span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>
        <span class="nt">&lt;ul&gt;</span>
          <span class="k">{{#</span><span class="nn">each</span> <span class="nv">author</span><span class="p">.</span><span class="nv">books</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">book</span><span class="err">|</span><span class="k">}}</span>
            <span class="nt">&lt;li&gt;</span><span class="k">{{</span><span class="nv">book</span><span class="p">.</span><span class="nv">title</span><span class="k">}}</span><span class="nt">&lt;/li&gt;</span>
          <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
        <span class="nt">&lt;/ul&gt;</span>
      <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="k">{{/</span><span class="nn">each</span><span class="k">}}</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span> 
</code></pre></div> <p>Implement <code class="highlighter-rouge">isNotValid</code> method in your model with adding this line to <code class="highlighter-rouge">app/models/author.js</code>:</p> <div class="highlighter-rouge"><pre class="highlight"><code>isNotValid: Ember.computed.empty('name'),
</code></pre></div> <p>And add <code class="highlighter-rouge">actions</code> to <code class="highlighter-rouge">app/routes/authors.js</code>:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/routes/authors.js</span>
<span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">'ember'</span><span class="p">;</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  
  <span class="nx">model</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">'author'</span><span class="p">);</span>
  <span class="p">},</span>
  
  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>
  
    <span class="nx">editAuthor</span><span class="p">(</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">author</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'isEditing'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">},</span>
  
    <span class="nx">cancelAuthorEdit</span><span class="p">(</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">author</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'isEditing'</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="nx">author</span><span class="p">.</span><span class="nx">rollbackAttributes</span><span class="p">();</span>
    <span class="p">},</span>
  
    <span class="nx">saveAuthor</span><span class="p">(</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>
  
      <span class="k">if</span> <span class="p">(</span><span class="nx">author</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'isNotValid'</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
  
      <span class="nx">author</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'isEditing'</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="nx">author</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div> <p>Check out your app. Click on a name, edit it, save or cancel. Hope everything works as expected.</p> <p>Any time when we invoke an action, it passes the selected <code class="highlighter-rouge">author</code> record to that function as a parameter, so we can set <code class="highlighter-rouge">isEditing</code> on that record only.</p> <p>In case of cancellation we revoke changes with <code class="highlighter-rouge">rollbackAttributes</code>.</p> <p>The <code class="highlighter-rouge">if</code> - <code class="highlighter-rouge">else</code> block in the template helps to manage <code class="highlighter-rouge">isEditing</code> state.</p> <p>It is a good practice wrapping <code class="highlighter-rouge">input</code> fields and buttons with <code class="highlighter-rouge">form</code> tag, because we can submit data with typing Enter in the input field. However, it works properly only if we add <code class="highlighter-rouge">on='submit'</code> to the <code class="highlighter-rouge">action</code>.</p> <p>There are two new classes in our stylesheet also, please extend <code class="highlighter-rouge">app/styles/app.scss</code>:</p> <div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="nc">.vtop</span> <span class="p">{</span>
  <span class="nl">vertical-align</span><span class="p">:</span> <span class="nb">top</span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.not-bold</span> <span class="p">{</span>
  <span class="nl">font-weight</span><span class="p">:</span> <span class="nb">normal</span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div> <p>Now you can try to create a list about books on Books page, with a simple table where you list <code class="highlighter-rouge">book.title</code> and <code class="highlighter-rouge">book.author.name</code>. You can use the above logic to update a book title if you click on it. Good luck! :)</p> <p>##TBC</p> <p>Well done you folks who made it this far. Keep up the good work.</p> <p>If you would like to know about new blog updates, please <a href="http://twitter.com/zoltan_nz">follow me on twitter</a>.</p> <div class="row"> <section class="col-sm-12"> <article class="blog-post-list-item"> <header> <p class="blog-post-meta home"> <a href="/categories/nodejs" title="Other posts from the category">NODEJS</a> / <time datetime="2016-09-23T23:50:00+12:00"> <span class="day"> 23 </span> <span class="month-year"> SEP 2016 </span> </time> </p> <h2 class="blog-post-title"> <a href="/nodejs/the-best-way-to-install-node-js/"> The Best Way to Install Node.js </a> </h2> </header> <section> <p>There are a few ways to install Node.js, but it looks only one way gives you the best experience for long term. On Mac The best way to install Node.js on Mac is nvm. https://github.com/creationix/nvm You have to have on...</p> </section> </article> <article class="blog-post-list-item"> <header> <p class="blog-post-meta home"> <a href="/categories/emberjs" title="Other posts from the category">EMBERJS</a> / <time datetime="2016-06-10T09:28:13+12:00"> <span class="day"> 10 </span> <span class="month-year"> JUN 2016 </span> </time> </p> <h2 class="blog-post-title"> <a href="/emberjs/how-to-keep-your-ember-js-project-up-to-date/"> How To Keep Your Ember.js Project Up-To-Date </a> </h2> </header> <section> <p>You can keep your Ember application up-to-date with a few simple steps. One of the most important that always follow and read the blog posts about the new version on Ember.js website. My strategy is quite simple. I would like...</p> </section> </article> </section> <aside class="col-sm-4"> </aside> </div> <div id="disqus_thread"></div> </div> <footer class="blog-footer"> <div class="container"> <div class="row"> <div class="col-xs-4"><a href="http://yoember.com">Ember.js tutorial</div> <div class="col-xs-4 text-center"><a href="/feed.xml">RSS</a></div> <div class="col-xs-4 text-right"><a href="#">Back to top</a></div> </div> </div> </footer> <script> (function (i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga'); ga('create', 'UA-68981696-1', 'auto'); ga('send', 'pageview'); </script> <script> var disqus_config = function () { this.page.url = 'http://yoember.com'; this.page.identifier = document.getElementsByTagName('body')[0].getAttribute('data-identifier') }; (function() { var d = document, s = d.createElement('script'); s.src = '//yoember.disqus.com/embed.js'; s.async = 1; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> </body> </html>
